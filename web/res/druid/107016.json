[{"authorTime":"2018-08-31 00:56:26","codes":[{"authorDate":"2018-08-31 00:56:26","commitOrder":1,"curCode":"  public void testBufferAggregate() throws Exception\n  {\n\n    final long[] timestamps = {1526724600L, 1526724700L, 1526724800L, 1526725900L, 1526725000L};\n    final String[] strings = {\"AAAA\", \"BBBB\", \"CCCC\", \"DDDD\", \"EEEE\"};\n    Integer maxStringBytes = 1024;\n\n    TestLongColumnSelector longColumnSelector = new TestLongColumnSelector(timestamps);\n    TestObjectColumnSelector<String> objectColumnSelector = new TestObjectColumnSelector<>(strings);\n\n    StringFirstAggregatorFactory factory = new StringFirstAggregatorFactory(\n        \"billy\", \"billy\", maxStringBytes\n    );\n\n    StringFirstBufferAggregator agg = new StringFirstBufferAggregator(\n        longColumnSelector,\n        objectColumnSelector,\n        maxStringBytes\n    );\n\n    String testString = \"ZZZZ\";\n\n    ByteBuffer buf = ByteBuffer.allocate(factory.getMaxIntermediateSize());\n    buf.putLong(1526728500L);\n    buf.putInt(testString.length());\n    buf.put(testString.getBytes(StandardCharsets.UTF_8));\n\n    int position = 0;\n\n    agg.init(buf, position);\n    \r\n    for (int i = 0; i < timestamps.length; i++) {\n      aggregateBuffer(longColumnSelector, objectColumnSelector, agg, buf, position);\n    }\n\n    SerializablePairLongString sp = ((SerializablePairLongString) agg.get(buf, position));\n\n\n    Assert.assertEquals(\"expectec last string value\", strings[0], sp.rhs);\n    Assert.assertEquals(\"last string timestamp is the biggest\", new Long(timestamps[0]), new Long(sp.lhs));\n\n  }\n","date":"2018-08-31 00:56:26","endLine":89,"groupId":"13154","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"testBufferAggregate","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-druid-10-0.7/blobInfo/CC_OUT/blobs/57/3d55a53467fe84ca1d59a522f253f0f157b039.src","preCode":"  public void testBufferAggregate() throws Exception\n  {\n\n    final long[] timestamps = {1526724600L, 1526724700L, 1526724800L, 1526725900L, 1526725000L};\n    final String[] strings = {\"AAAA\", \"BBBB\", \"CCCC\", \"DDDD\", \"EEEE\"};\n    Integer maxStringBytes = 1024;\n\n    TestLongColumnSelector longColumnSelector = new TestLongColumnSelector(timestamps);\n    TestObjectColumnSelector<String> objectColumnSelector = new TestObjectColumnSelector<>(strings);\n\n    StringFirstAggregatorFactory factory = new StringFirstAggregatorFactory(\n        \"billy\", \"billy\", maxStringBytes\n    );\n\n    StringFirstBufferAggregator agg = new StringFirstBufferAggregator(\n        longColumnSelector,\n        objectColumnSelector,\n        maxStringBytes\n    );\n\n    String testString = \"ZZZZ\";\n\n    ByteBuffer buf = ByteBuffer.allocate(factory.getMaxIntermediateSize());\n    buf.putLong(1526728500L);\n    buf.putInt(testString.length());\n    buf.put(testString.getBytes(StandardCharsets.UTF_8));\n\n    int position = 0;\n\n    agg.init(buf, position);\n    \r\n    for (int i = 0; i < timestamps.length; i++) {\n      aggregateBuffer(longColumnSelector, objectColumnSelector, agg, buf, position);\n    }\n\n    SerializablePairLongString sp = ((SerializablePairLongString) agg.get(buf, position));\n\n\n    Assert.assertEquals(\"expectec last string value\", strings[0], sp.rhs);\n    Assert.assertEquals(\"last string timestamp is the biggest\", new Long(timestamps[0]), new Long(sp.lhs));\n\n  }\n","realPath":"processing/src/test/java/org/apache/druid/query/aggregation/first/StringFirstBufferAggregatorTest.java","repoName":"druid","snippetEndLine":0,"snippetStartLine":0,"startLine":48,"status":"B"},{"authorDate":"2018-08-31 00:56:26","commitOrder":1,"curCode":"  public void testBufferAggregate() throws Exception\n  {\n\n    final long[] timestamps = {1526724600L, 1526724700L, 1526724800L, 1526725900L, 1526725000L};\n    final String[] strings = {\"AAAA\", \"BBBB\", \"CCCC\", \"DDDD\", \"EEEE\"};\n    Integer maxStringBytes = 1024;\n\n    TestLongColumnSelector longColumnSelector = new TestLongColumnSelector(timestamps);\n    TestObjectColumnSelector<String> objectColumnSelector = new TestObjectColumnSelector<>(strings);\n\n    StringLastAggregatorFactory factory = new StringLastAggregatorFactory(\n        \"billy\", \"billy\", maxStringBytes\n    );\n\n    StringLastBufferAggregator agg = new StringLastBufferAggregator(\n        longColumnSelector,\n        objectColumnSelector,\n        maxStringBytes\n    );\n\n    String testString = \"ZZZZ\";\n\n    ByteBuffer buf = ByteBuffer.allocate(factory.getMaxIntermediateSize());\n    buf.putLong(1526728500L);\n    buf.putInt(testString.length());\n    buf.put(testString.getBytes(StandardCharsets.UTF_8));\n\n    int position = 0;\n\n    agg.init(buf, position);\n    \r\n    for (int i = 0; i < timestamps.length; i++) {\n      aggregateBuffer(longColumnSelector, objectColumnSelector, agg, buf, position);\n    }\n\n    SerializablePairLongString sp = ((SerializablePairLongString) agg.get(buf, position));\n\n\n    Assert.assertEquals(\"expectec last string value\", \"DDDD\", sp.rhs);\n    Assert.assertEquals(\"last string timestamp is the biggest\", new Long(1526725900L), new Long(sp.lhs));\n\n  }\n","date":"2018-08-31 00:56:26","endLine":89,"groupId":"13154","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"testBufferAggregate","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-druid-10-0.7/blobInfo/CC_OUT/blobs/e6/21a4eb390b2ca4e7a22f4646c5b485c9173e81.src","preCode":"  public void testBufferAggregate() throws Exception\n  {\n\n    final long[] timestamps = {1526724600L, 1526724700L, 1526724800L, 1526725900L, 1526725000L};\n    final String[] strings = {\"AAAA\", \"BBBB\", \"CCCC\", \"DDDD\", \"EEEE\"};\n    Integer maxStringBytes = 1024;\n\n    TestLongColumnSelector longColumnSelector = new TestLongColumnSelector(timestamps);\n    TestObjectColumnSelector<String> objectColumnSelector = new TestObjectColumnSelector<>(strings);\n\n    StringLastAggregatorFactory factory = new StringLastAggregatorFactory(\n        \"billy\", \"billy\", maxStringBytes\n    );\n\n    StringLastBufferAggregator agg = new StringLastBufferAggregator(\n        longColumnSelector,\n        objectColumnSelector,\n        maxStringBytes\n    );\n\n    String testString = \"ZZZZ\";\n\n    ByteBuffer buf = ByteBuffer.allocate(factory.getMaxIntermediateSize());\n    buf.putLong(1526728500L);\n    buf.putInt(testString.length());\n    buf.put(testString.getBytes(StandardCharsets.UTF_8));\n\n    int position = 0;\n\n    agg.init(buf, position);\n    \r\n    for (int i = 0; i < timestamps.length; i++) {\n      aggregateBuffer(longColumnSelector, objectColumnSelector, agg, buf, position);\n    }\n\n    SerializablePairLongString sp = ((SerializablePairLongString) agg.get(buf, position));\n\n\n    Assert.assertEquals(\"expectec last string value\", \"DDDD\", sp.rhs);\n    Assert.assertEquals(\"last string timestamp is the biggest\", new Long(1526725900L), new Long(sp.lhs));\n\n  }\n","realPath":"processing/src/test/java/org/apache/druid/query/aggregation/last/StringLastBufferAggregatorTest.java","repoName":"druid","snippetEndLine":0,"snippetStartLine":0,"startLine":48,"status":"B"}],"commitId":"431d3d8497f9079857c3baa7ae7ab4cb44a22355","commitMessage":"@@@Rename io.druid to org.apache.druid. (#6266)\n\n* Rename io.druid to org.apache.druid.\n\n* Fix META-INF files and remove some benchmark results.\n\n* MonitorsConfig update for metrics package migration.\n\n* Reorder some dimensions in inner queries for some reason.\n\n* Fix protobuf tests.\n","date":"2018-08-31 00:56:26","modifiedFileCount":"5","status":"B","submitter":"Gian Merlino"},{"authorTime":"2019-03-26 08:11:01","codes":[{"authorDate":"2019-03-26 08:11:01","commitOrder":2,"curCode":"  public void testBufferAggregate()\n  {\n\n    final long[] timestamps = {1526724600L, 1526724700L, 1526724800L, 1526725900L, 1526725000L};\n    final String[] strings = {\"AAAA\", \"BBBB\", \"CCCC\", \"DDDD\", \"EEEE\"};\n    Integer maxStringBytes = 1024;\n\n    TestLongColumnSelector longColumnSelector = new TestLongColumnSelector(timestamps);\n    TestObjectColumnSelector<String> objectColumnSelector = new TestObjectColumnSelector<>(strings);\n\n    StringFirstAggregatorFactory factory = new StringFirstAggregatorFactory(\n        \"billy\", \"billy\", maxStringBytes\n    );\n\n    StringFirstBufferAggregator agg = new StringFirstBufferAggregator(\n        longColumnSelector,\n        objectColumnSelector,\n        maxStringBytes\n    );\n\n    String testString = \"ZZZZ\";\n\n    ByteBuffer buf = ByteBuffer.allocate(factory.getMaxIntermediateSize());\n    buf.putLong(1526728500L);\n    buf.putInt(testString.length());\n    buf.put(testString.getBytes(StandardCharsets.UTF_8));\n\n    int position = 0;\n\n    agg.init(buf, position);\n    \r\n    for (int i = 0; i < timestamps.length; i++) {\n      aggregateBuffer(longColumnSelector, objectColumnSelector, agg, buf, position);\n    }\n\n    SerializablePairLongString sp = ((SerializablePairLongString) agg.get(buf, position));\n\n\n    Assert.assertEquals(\"expectec last string value\", strings[0], sp.rhs);\n    Assert.assertEquals(\"last string timestamp is the biggest\", new Long(timestamps[0]), new Long(sp.lhs));\n\n  }\n","date":"2019-03-26 08:11:01","endLine":89,"groupId":"13154","id":3,"instanceNumber":1,"isCurCommit":0,"methodName":"testBufferAggregate","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-druid-10-0.7/blobInfo/CC_OUT/blobs/7d/3e0566f15cc6cb8a537cc8a169e37dfbc0ab04.src","preCode":"  public void testBufferAggregate() throws Exception\n  {\n\n    final long[] timestamps = {1526724600L, 1526724700L, 1526724800L, 1526725900L, 1526725000L};\n    final String[] strings = {\"AAAA\", \"BBBB\", \"CCCC\", \"DDDD\", \"EEEE\"};\n    Integer maxStringBytes = 1024;\n\n    TestLongColumnSelector longColumnSelector = new TestLongColumnSelector(timestamps);\n    TestObjectColumnSelector<String> objectColumnSelector = new TestObjectColumnSelector<>(strings);\n\n    StringFirstAggregatorFactory factory = new StringFirstAggregatorFactory(\n        \"billy\", \"billy\", maxStringBytes\n    );\n\n    StringFirstBufferAggregator agg = new StringFirstBufferAggregator(\n        longColumnSelector,\n        objectColumnSelector,\n        maxStringBytes\n    );\n\n    String testString = \"ZZZZ\";\n\n    ByteBuffer buf = ByteBuffer.allocate(factory.getMaxIntermediateSize());\n    buf.putLong(1526728500L);\n    buf.putInt(testString.length());\n    buf.put(testString.getBytes(StandardCharsets.UTF_8));\n\n    int position = 0;\n\n    agg.init(buf, position);\n    \r\n    for (int i = 0; i < timestamps.length; i++) {\n      aggregateBuffer(longColumnSelector, objectColumnSelector, agg, buf, position);\n    }\n\n    SerializablePairLongString sp = ((SerializablePairLongString) agg.get(buf, position));\n\n\n    Assert.assertEquals(\"expectec last string value\", strings[0], sp.rhs);\n    Assert.assertEquals(\"last string timestamp is the biggest\", new Long(timestamps[0]), new Long(sp.lhs));\n\n  }\n","realPath":"processing/src/test/java/org/apache/druid/query/aggregation/first/StringFirstBufferAggregatorTest.java","repoName":"druid","snippetEndLine":0,"snippetStartLine":0,"startLine":48,"status":"M"},{"authorDate":"2019-03-26 08:11:01","commitOrder":2,"curCode":"  public void testBufferAggregate()\n  {\n\n    final long[] timestamps = {1526724600L, 1526724700L, 1526724800L, 1526725900L, 1526725000L};\n    final String[] strings = {\"AAAA\", \"BBBB\", \"CCCC\", \"DDDD\", \"EEEE\"};\n    Integer maxStringBytes = 1024;\n\n    TestLongColumnSelector longColumnSelector = new TestLongColumnSelector(timestamps);\n    TestObjectColumnSelector<String> objectColumnSelector = new TestObjectColumnSelector<>(strings);\n\n    StringLastAggregatorFactory factory = new StringLastAggregatorFactory(\n        \"billy\", \"billy\", maxStringBytes\n    );\n\n    StringLastBufferAggregator agg = new StringLastBufferAggregator(\n        longColumnSelector,\n        objectColumnSelector,\n        maxStringBytes\n    );\n\n    String testString = \"ZZZZ\";\n\n    ByteBuffer buf = ByteBuffer.allocate(factory.getMaxIntermediateSize());\n    buf.putLong(1526728500L);\n    buf.putInt(testString.length());\n    buf.put(testString.getBytes(StandardCharsets.UTF_8));\n\n    int position = 0;\n\n    agg.init(buf, position);\n    \r\n    for (int i = 0; i < timestamps.length; i++) {\n      aggregateBuffer(longColumnSelector, objectColumnSelector, agg, buf, position);\n    }\n\n    SerializablePairLongString sp = ((SerializablePairLongString) agg.get(buf, position));\n\n\n    Assert.assertEquals(\"expectec last string value\", \"DDDD\", sp.rhs);\n    Assert.assertEquals(\"last string timestamp is the biggest\", new Long(1526725900L), new Long(sp.lhs));\n\n  }\n","date":"2019-03-26 08:11:01","endLine":89,"groupId":"13154","id":4,"instanceNumber":2,"isCurCommit":0,"methodName":"testBufferAggregate","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-druid-10-0.7/blobInfo/CC_OUT/blobs/c3/de5989119c4322bbd9456568727261a715efb2.src","preCode":"  public void testBufferAggregate() throws Exception\n  {\n\n    final long[] timestamps = {1526724600L, 1526724700L, 1526724800L, 1526725900L, 1526725000L};\n    final String[] strings = {\"AAAA\", \"BBBB\", \"CCCC\", \"DDDD\", \"EEEE\"};\n    Integer maxStringBytes = 1024;\n\n    TestLongColumnSelector longColumnSelector = new TestLongColumnSelector(timestamps);\n    TestObjectColumnSelector<String> objectColumnSelector = new TestObjectColumnSelector<>(strings);\n\n    StringLastAggregatorFactory factory = new StringLastAggregatorFactory(\n        \"billy\", \"billy\", maxStringBytes\n    );\n\n    StringLastBufferAggregator agg = new StringLastBufferAggregator(\n        longColumnSelector,\n        objectColumnSelector,\n        maxStringBytes\n    );\n\n    String testString = \"ZZZZ\";\n\n    ByteBuffer buf = ByteBuffer.allocate(factory.getMaxIntermediateSize());\n    buf.putLong(1526728500L);\n    buf.putInt(testString.length());\n    buf.put(testString.getBytes(StandardCharsets.UTF_8));\n\n    int position = 0;\n\n    agg.init(buf, position);\n    \r\n    for (int i = 0; i < timestamps.length; i++) {\n      aggregateBuffer(longColumnSelector, objectColumnSelector, agg, buf, position);\n    }\n\n    SerializablePairLongString sp = ((SerializablePairLongString) agg.get(buf, position));\n\n\n    Assert.assertEquals(\"expectec last string value\", \"DDDD\", sp.rhs);\n    Assert.assertEquals(\"last string timestamp is the biggest\", new Long(1526725900L), new Long(sp.lhs));\n\n  }\n","realPath":"processing/src/test/java/org/apache/druid/query/aggregation/last/StringLastBufferAggregatorTest.java","repoName":"druid","snippetEndLine":0,"snippetStartLine":0,"startLine":48,"status":"M"}],"commitId":"bca40dcdaf3177b95d01187f413e1c0c6865964b","commitMessage":"@@@Fix some IntelliJ inspections (#7273)\n\nPrepare TeamCity for IntelliJ 2018.3.1 upgrade. Mostly removed redundant exceptions declarations in `throws` clauses.","date":"2019-03-26 08:11:01","modifiedFileCount":"26","status":"M","submitter":"Roman Leventov"},{"authorTime":"2019-11-08 09:46:59","codes":[{"authorDate":"2019-11-08 09:46:59","commitOrder":3,"curCode":"  public void testBufferAggregate()\n  {\n\n    final long[] timestamps = {1526724600L, 1526724700L, 1526724800L, 1526725900L, 1526725000L};\n    final String[] strings = {\"AAAA\", \"BBBB\", \"CCCC\", \"DDDD\", \"EEEE\"};\n    Integer maxStringBytes = 1024;\n\n    TestLongColumnSelector longColumnSelector = new TestLongColumnSelector(timestamps);\n    TestObjectColumnSelector<String> objectColumnSelector = new TestObjectColumnSelector<>(strings);\n\n    StringFirstAggregatorFactory factory = new StringFirstAggregatorFactory(\n        \"billy\", \"billy\", maxStringBytes\n    );\n\n    StringFirstBufferAggregator agg = new StringFirstBufferAggregator(\n        longColumnSelector,\n        objectColumnSelector,\n        maxStringBytes\n    );\n\n    ByteBuffer buf = ByteBuffer.allocate(factory.getMaxIntermediateSize());\n    int position = 0;\n\n    agg.init(buf, position);\n    \r\n    for (int i = 0; i < timestamps.length; i++) {\n      aggregateBuffer(longColumnSelector, objectColumnSelector, agg, buf, position);\n    }\n\n    SerializablePairLongString sp = ((SerializablePairLongString) agg.get(buf, position));\n\n\n    Assert.assertEquals(\"expected last string value\", strings[0], sp.rhs);\n    Assert.assertEquals(\"last string timestamp is the biggest\", new Long(timestamps[0]), new Long(sp.lhs));\n\n  }\n","date":"2019-11-08 09:46:59","endLine":82,"groupId":"13154","id":5,"instanceNumber":1,"isCurCommit":0,"methodName":"testBufferAggregate","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-druid-10-0.7/blobInfo/CC_OUT/blobs/04/700fae42dfb8847708869a67c62e80e786a901.src","preCode":"  public void testBufferAggregate()\n  {\n\n    final long[] timestamps = {1526724600L, 1526724700L, 1526724800L, 1526725900L, 1526725000L};\n    final String[] strings = {\"AAAA\", \"BBBB\", \"CCCC\", \"DDDD\", \"EEEE\"};\n    Integer maxStringBytes = 1024;\n\n    TestLongColumnSelector longColumnSelector = new TestLongColumnSelector(timestamps);\n    TestObjectColumnSelector<String> objectColumnSelector = new TestObjectColumnSelector<>(strings);\n\n    StringFirstAggregatorFactory factory = new StringFirstAggregatorFactory(\n        \"billy\", \"billy\", maxStringBytes\n    );\n\n    StringFirstBufferAggregator agg = new StringFirstBufferAggregator(\n        longColumnSelector,\n        objectColumnSelector,\n        maxStringBytes\n    );\n\n    String testString = \"ZZZZ\";\n\n    ByteBuffer buf = ByteBuffer.allocate(factory.getMaxIntermediateSize());\n    buf.putLong(1526728500L);\n    buf.putInt(testString.length());\n    buf.put(testString.getBytes(StandardCharsets.UTF_8));\n\n    int position = 0;\n\n    agg.init(buf, position);\n    \r\n    for (int i = 0; i < timestamps.length; i++) {\n      aggregateBuffer(longColumnSelector, objectColumnSelector, agg, buf, position);\n    }\n\n    SerializablePairLongString sp = ((SerializablePairLongString) agg.get(buf, position));\n\n\n    Assert.assertEquals(\"expectec last string value\", strings[0], sp.rhs);\n    Assert.assertEquals(\"last string timestamp is the biggest\", new Long(timestamps[0]), new Long(sp.lhs));\n\n  }\n","realPath":"processing/src/test/java/org/apache/druid/query/aggregation/first/StringFirstBufferAggregatorTest.java","repoName":"druid","snippetEndLine":0,"snippetStartLine":0,"startLine":47,"status":"M"},{"authorDate":"2019-11-08 09:46:59","commitOrder":3,"curCode":"  public void testBufferAggregate()\n  {\n\n    final long[] timestamps = {1526724600L, 1526724700L, 1526724800L, 1526725900L, 1526725000L};\n    final String[] strings = {\"AAAA\", \"BBBB\", \"CCCC\", \"DDDD\", \"EEEE\"};\n    Integer maxStringBytes = 1024;\n\n    TestLongColumnSelector longColumnSelector = new TestLongColumnSelector(timestamps);\n    TestObjectColumnSelector<String> objectColumnSelector = new TestObjectColumnSelector<>(strings);\n\n    StringLastAggregatorFactory factory = new StringLastAggregatorFactory(\n        \"billy\", \"billy\", maxStringBytes\n    );\n\n    StringLastBufferAggregator agg = new StringLastBufferAggregator(\n        longColumnSelector,\n        objectColumnSelector,\n        maxStringBytes\n    );\n\n    ByteBuffer buf = ByteBuffer.allocate(factory.getMaxIntermediateSize());\n    int position = 0;\n\n    agg.init(buf, position);\n    \r\n    for (int i = 0; i < timestamps.length; i++) {\n      aggregateBuffer(longColumnSelector, objectColumnSelector, agg, buf, position);\n    }\n\n    SerializablePairLongString sp = ((SerializablePairLongString) agg.get(buf, position));\n\n\n    Assert.assertEquals(\"expectec last string value\", \"DDDD\", sp.rhs);\n    Assert.assertEquals(\"last string timestamp is the biggest\", new Long(1526725900L), new Long(sp.lhs));\n\n  }\n","date":"2019-11-08 09:46:59","endLine":82,"groupId":"13154","id":6,"instanceNumber":2,"isCurCommit":0,"methodName":"testBufferAggregate","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-druid-10-0.7/blobInfo/CC_OUT/blobs/18/a378855a6f16c15bf1cc7caf9ba1ebe21a1616.src","preCode":"  public void testBufferAggregate()\n  {\n\n    final long[] timestamps = {1526724600L, 1526724700L, 1526724800L, 1526725900L, 1526725000L};\n    final String[] strings = {\"AAAA\", \"BBBB\", \"CCCC\", \"DDDD\", \"EEEE\"};\n    Integer maxStringBytes = 1024;\n\n    TestLongColumnSelector longColumnSelector = new TestLongColumnSelector(timestamps);\n    TestObjectColumnSelector<String> objectColumnSelector = new TestObjectColumnSelector<>(strings);\n\n    StringLastAggregatorFactory factory = new StringLastAggregatorFactory(\n        \"billy\", \"billy\", maxStringBytes\n    );\n\n    StringLastBufferAggregator agg = new StringLastBufferAggregator(\n        longColumnSelector,\n        objectColumnSelector,\n        maxStringBytes\n    );\n\n    String testString = \"ZZZZ\";\n\n    ByteBuffer buf = ByteBuffer.allocate(factory.getMaxIntermediateSize());\n    buf.putLong(1526728500L);\n    buf.putInt(testString.length());\n    buf.put(testString.getBytes(StandardCharsets.UTF_8));\n\n    int position = 0;\n\n    agg.init(buf, position);\n    \r\n    for (int i = 0; i < timestamps.length; i++) {\n      aggregateBuffer(longColumnSelector, objectColumnSelector, agg, buf, position);\n    }\n\n    SerializablePairLongString sp = ((SerializablePairLongString) agg.get(buf, position));\n\n\n    Assert.assertEquals(\"expectec last string value\", \"DDDD\", sp.rhs);\n    Assert.assertEquals(\"last string timestamp is the biggest\", new Long(1526725900L), new Long(sp.lhs));\n\n  }\n","realPath":"processing/src/test/java/org/apache/druid/query/aggregation/last/StringLastBufferAggregatorTest.java","repoName":"druid","snippetEndLine":0,"snippetStartLine":0,"startLine":47,"status":"M"}],"commitId":"c204d6837613ef2a36eb093707e66db78407311b","commitMessage":"@@@Fixes.  adjustments to numeric null handling and string first/last aggregators. (#8834)\n\nThere is a class of bugs due to the fact that BaseObjectColumnValueSelector\nhas both \"getObject\" and \"isNull\" methods.  but in most selector implementations\nand most call sites.  it is clear that the intent of \"isNull\" is only to apply\nto the primitive getters.  not the object getter. This makes sense.  because the\npurpose of isNull is to enable detection of nulls in otherwise-primitive columns.\nImagine a string column with a numeric selector built on top of it. You would\nwant it to return isNull = true.  so numeric aggregators don't treat it as\nall zeroes.\n\nSometimes this design leads people to accidentally guard non-primitive get\nmethods with \"selector.isNull\" checks.  which is improper.\n\nThis patch has three goals:\n\n1) Fix null-handling bugs that already exist in this class.\n2) Make interface and doc changes that reduce the probability of future bugs.\n3) Fix other.  unrelated bugs I noticed in the stringFirst and stringLast\n   aggregators while fixing null-handling bugs. I thought about splitting this\n   into its own patch.  but it ended up being tough to split from the\n   null-handling fixes.\n\nFor (1) the fixes are. \n\n- Fix StringFirst and StringLastAggregatorFactory to stop guarding getObject\n  calls on isNull.  by no longer extending NullableAggregatorFactory. Now uses\n  -1 as a sigil value for null.  to differentiate nulls and empty strings.\n- Fix ExpressionFilter to stop guarding getObject calls on isNull. Also.  use\n  eval.asBoolean() to avoid calling getLong on the selector after already\n  calling getObject.\n- Fix ObjectBloomFilterAggregator to stop guarding DimensionSelector calls\n  on isNull. Also.  refactored slightly to avoid the overhead of calling\n  getObject followed by another getter (see BloomFilterAggregatorFactory for\n  part of this).\n\nFor (2) the main changes are. \n\n- Remove the \"isNull\" method from BaseObjectColumnValueSelector.\n- Clarify \"isNull\" doc on BaseNullableColumnValueSelector.\n- Rename NullableAggregatorFactory -> NullbleNumericAggregatorFactory to emphasize\n  that it only works on aggregators that take numbers as input.\n- Similar naming changes to the Aggregator.  BufferAggregator.  and AggregateCombiner.\n- Similar naming changes to helper methods for groupBy.  ValueMatchers.  etc.\n\nFor (3) the other fixes for StringFirst and StringLastAggregatorFactory are. \n\n- Fixed buffer overrun in the buffer aggregators when some characters in the string\n  code into more than one byte (the old code used \"substring\" to apply a byte limit. \n  which is bad). I did this by introducing a new StringUtils.toUtf8WithLimit method.\n- Fixed weird IncrementalIndex logic that led to reading nulls for the timestamp.\n- Adjusted weird StringFirst/Last logic that worked around the weird IncrementalIndex\n  behavior.\n- Refactored to share code between the four aggregators.\n- Improved test coverage.\n- Made the base stringFirst.  stringLast aggregators adaptive.  and streamlined the\n  xFold versions into aliases. The adaptiveness is similar to how other aggregators\n  like hyperUnique work.","date":"2019-11-08 09:46:59","modifiedFileCount":"45","status":"M","submitter":"Gian Merlino"},{"authorTime":"2020-01-17 13:02:02","codes":[{"authorDate":"2020-01-17 13:02:02","commitOrder":4,"curCode":"  public void testBufferAggregate()\n  {\n    final long[] timestamps = {1526724600L, 1526724700L, 1526724800L, 1526725900L, 1526725000L};\n    final String[] strings = {\"AAAA\", \"BBBB\", \"CCCC\", \"DDDD\", \"EEEE\"};\n    Integer maxStringBytes = 1024;\n\n    TestLongColumnSelector longColumnSelector = new TestLongColumnSelector(timestamps);\n    TestObjectColumnSelector<String> objectColumnSelector = new TestObjectColumnSelector<>(strings);\n\n    StringFirstAggregatorFactory factory = new StringFirstAggregatorFactory(\n        \"billy\", \"billy\", maxStringBytes\n    );\n\n    StringFirstBufferAggregator agg = new StringFirstBufferAggregator(\n        longColumnSelector,\n        objectColumnSelector,\n        maxStringBytes,\n        false\n    );\n\n    ByteBuffer buf = ByteBuffer.allocate(factory.getMaxIntermediateSize());\n    int position = 0;\n\n    agg.init(buf, position);\n    \r\n    for (int i = 0; i < timestamps.length; i++) {\n      aggregateBuffer(longColumnSelector, objectColumnSelector, agg, buf, position);\n    }\n\n    SerializablePairLongString sp = ((SerializablePairLongString) agg.get(buf, position));\n\n\n    Assert.assertEquals(\"expected last string value\", strings[0], sp.rhs);\n    Assert.assertEquals(\"last string timestamp is the biggest\", new Long(timestamps[0]), new Long(sp.lhs));\n  }\n","date":"2020-01-17 13:02:02","endLine":81,"groupId":"13154","id":7,"instanceNumber":1,"isCurCommit":0,"methodName":"testBufferAggregate","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-druid-10-0.7/blobInfo/CC_OUT/blobs/3b/4ef692bf5238c53369a22a299cbc3a5c4e8efa.src","preCode":"  public void testBufferAggregate()\n  {\n\n    final long[] timestamps = {1526724600L, 1526724700L, 1526724800L, 1526725900L, 1526725000L};\n    final String[] strings = {\"AAAA\", \"BBBB\", \"CCCC\", \"DDDD\", \"EEEE\"};\n    Integer maxStringBytes = 1024;\n\n    TestLongColumnSelector longColumnSelector = new TestLongColumnSelector(timestamps);\n    TestObjectColumnSelector<String> objectColumnSelector = new TestObjectColumnSelector<>(strings);\n\n    StringFirstAggregatorFactory factory = new StringFirstAggregatorFactory(\n        \"billy\", \"billy\", maxStringBytes\n    );\n\n    StringFirstBufferAggregator agg = new StringFirstBufferAggregator(\n        longColumnSelector,\n        objectColumnSelector,\n        maxStringBytes\n    );\n\n    ByteBuffer buf = ByteBuffer.allocate(factory.getMaxIntermediateSize());\n    int position = 0;\n\n    agg.init(buf, position);\n    \r\n    for (int i = 0; i < timestamps.length; i++) {\n      aggregateBuffer(longColumnSelector, objectColumnSelector, agg, buf, position);\n    }\n\n    SerializablePairLongString sp = ((SerializablePairLongString) agg.get(buf, position));\n\n\n    Assert.assertEquals(\"expected last string value\", strings[0], sp.rhs);\n    Assert.assertEquals(\"last string timestamp is the biggest\", new Long(timestamps[0]), new Long(sp.lhs));\n\n  }\n","realPath":"processing/src/test/java/org/apache/druid/query/aggregation/first/StringFirstBufferAggregatorTest.java","repoName":"druid","snippetEndLine":0,"snippetStartLine":0,"startLine":47,"status":"M"},{"authorDate":"2020-01-17 13:02:02","commitOrder":4,"curCode":"  public void testBufferAggregate()\n  {\n\n    final long[] timestamps = {1526724600L, 1526724700L, 1526724800L, 1526725900L, 1526725000L};\n    final String[] strings = {\"AAAA\", \"BBBB\", \"CCCC\", \"DDDD\", \"EEEE\"};\n    Integer maxStringBytes = 1024;\n\n    TestLongColumnSelector longColumnSelector = new TestLongColumnSelector(timestamps);\n    TestObjectColumnSelector<String> objectColumnSelector = new TestObjectColumnSelector<>(strings);\n\n    StringLastAggregatorFactory factory = new StringLastAggregatorFactory(\n        \"billy\", \"billy\", maxStringBytes\n    );\n\n    StringLastBufferAggregator agg = new StringLastBufferAggregator(\n        longColumnSelector,\n        objectColumnSelector,\n        maxStringBytes,\n        false\n    );\n\n    ByteBuffer buf = ByteBuffer.allocate(factory.getMaxIntermediateSize());\n    int position = 0;\n\n    agg.init(buf, position);\n    \r\n    for (int i = 0; i < timestamps.length; i++) {\n      aggregateBuffer(longColumnSelector, objectColumnSelector, agg, buf, position);\n    }\n\n    SerializablePairLongString sp = ((SerializablePairLongString) agg.get(buf, position));\n\n\n    Assert.assertEquals(\"expected last string value\", \"DDDD\", sp.rhs);\n    Assert.assertEquals(\"last string timestamp is the biggest\", new Long(1526725900L), new Long(sp.lhs));\n\n  }\n","date":"2020-01-17 13:02:02","endLine":83,"groupId":"13154","id":8,"instanceNumber":2,"isCurCommit":0,"methodName":"testBufferAggregate","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-druid-10-0.7/blobInfo/CC_OUT/blobs/6c/350c4cff1eb8dcceead40874aaafe0e20b9138.src","preCode":"  public void testBufferAggregate()\n  {\n\n    final long[] timestamps = {1526724600L, 1526724700L, 1526724800L, 1526725900L, 1526725000L};\n    final String[] strings = {\"AAAA\", \"BBBB\", \"CCCC\", \"DDDD\", \"EEEE\"};\n    Integer maxStringBytes = 1024;\n\n    TestLongColumnSelector longColumnSelector = new TestLongColumnSelector(timestamps);\n    TestObjectColumnSelector<String> objectColumnSelector = new TestObjectColumnSelector<>(strings);\n\n    StringLastAggregatorFactory factory = new StringLastAggregatorFactory(\n        \"billy\", \"billy\", maxStringBytes\n    );\n\n    StringLastBufferAggregator agg = new StringLastBufferAggregator(\n        longColumnSelector,\n        objectColumnSelector,\n        maxStringBytes\n    );\n\n    ByteBuffer buf = ByteBuffer.allocate(factory.getMaxIntermediateSize());\n    int position = 0;\n\n    agg.init(buf, position);\n    \r\n    for (int i = 0; i < timestamps.length; i++) {\n      aggregateBuffer(longColumnSelector, objectColumnSelector, agg, buf, position);\n    }\n\n    SerializablePairLongString sp = ((SerializablePairLongString) agg.get(buf, position));\n\n\n    Assert.assertEquals(\"expectec last string value\", \"DDDD\", sp.rhs);\n    Assert.assertEquals(\"last string timestamp is the biggest\", new Long(1526725900L), new Long(sp.lhs));\n\n  }\n","realPath":"processing/src/test/java/org/apache/druid/query/aggregation/last/StringLastBufferAggregatorTest.java","repoName":"druid","snippetEndLine":0,"snippetStartLine":0,"startLine":47,"status":"M"}],"commitId":"448da787654ef6ebcab7bb5cba340b931c454320","commitMessage":"@@@Speed up String first/last aggregators when folding isn't needed. (#9181)\n\n* Speed up String first/last aggregators when folding isn't needed.\n\nExamines the value column.  and disables fold checking via a needsFoldCheck\nflag if that column can't possibly contain SerializableLongStringPairs. This\nis helpful because it avoids calling getObject on the value selector when\nunnecessary; say.  because the time selector didn't yield an earlier or later\nvalue.\n\n* PR comments.\n\n* Move fastLooseChop to StringUtils.\n","date":"2020-01-17 13:02:02","modifiedFileCount":"13","status":"M","submitter":"Gian Merlino"},{"authorTime":"2020-01-30 03:50:52","codes":[{"authorDate":"2020-01-30 03:50:52","commitOrder":5,"curCode":"  public void testBufferAggregate()\n  {\n    final long[] timestamps = {1526724600L, 1526724700L, 1526724800L, 1526725900L, 1526725000L};\n    final String[] strings = {\"AAAA\", \"BBBB\", \"CCCC\", \"DDDD\", \"EEEE\"};\n    Integer maxStringBytes = 1024;\n\n    TestLongColumnSelector longColumnSelector = new TestLongColumnSelector(timestamps);\n    TestObjectColumnSelector<String> objectColumnSelector = new TestObjectColumnSelector<>(strings);\n\n    StringFirstAggregatorFactory factory = new StringFirstAggregatorFactory(\n        \"billy\", \"billy\", maxStringBytes\n    );\n\n    StringFirstBufferAggregator agg = new StringFirstBufferAggregator(\n        longColumnSelector,\n        objectColumnSelector,\n        maxStringBytes,\n        false\n    );\n\n    ByteBuffer buf = ByteBuffer.allocate(factory.getMaxIntermediateSize());\n    int position = 0;\n\n    agg.init(buf, position);\n    \r\n    for (int i = 0; i < timestamps.length; i++) {\n      aggregateBuffer(longColumnSelector, objectColumnSelector, agg, buf, position);\n    }\n\n    SerializablePairLongString sp = ((SerializablePairLongString) agg.get(buf, position));\n\n\n    Assert.assertEquals(\"expected last string value\", strings[0], sp.rhs);\n    Assert.assertEquals(\"last string timestamp is the biggest\", new Long(timestamps[0]), sp.lhs);\n  }\n","date":"2020-01-30 03:50:52","endLine":81,"groupId":"107016","id":9,"instanceNumber":1,"isCurCommit":1,"methodName":"testBufferAggregate","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-druid-10-0.7/blobInfo/CC_OUT/blobs/36/8bad99fe6def11570aa45c0f26e46f9a8a76da.src","preCode":"  public void testBufferAggregate()\n  {\n    final long[] timestamps = {1526724600L, 1526724700L, 1526724800L, 1526725900L, 1526725000L};\n    final String[] strings = {\"AAAA\", \"BBBB\", \"CCCC\", \"DDDD\", \"EEEE\"};\n    Integer maxStringBytes = 1024;\n\n    TestLongColumnSelector longColumnSelector = new TestLongColumnSelector(timestamps);\n    TestObjectColumnSelector<String> objectColumnSelector = new TestObjectColumnSelector<>(strings);\n\n    StringFirstAggregatorFactory factory = new StringFirstAggregatorFactory(\n        \"billy\", \"billy\", maxStringBytes\n    );\n\n    StringFirstBufferAggregator agg = new StringFirstBufferAggregator(\n        longColumnSelector,\n        objectColumnSelector,\n        maxStringBytes,\n        false\n    );\n\n    ByteBuffer buf = ByteBuffer.allocate(factory.getMaxIntermediateSize());\n    int position = 0;\n\n    agg.init(buf, position);\n    \r\n    for (int i = 0; i < timestamps.length; i++) {\n      aggregateBuffer(longColumnSelector, objectColumnSelector, agg, buf, position);\n    }\n\n    SerializablePairLongString sp = ((SerializablePairLongString) agg.get(buf, position));\n\n\n    Assert.assertEquals(\"expected last string value\", strings[0], sp.rhs);\n    Assert.assertEquals(\"last string timestamp is the biggest\", new Long(timestamps[0]), new Long(sp.lhs));\n  }\n","realPath":"processing/src/test/java/org/apache/druid/query/aggregation/first/StringFirstBufferAggregatorTest.java","repoName":"druid","snippetEndLine":0,"snippetStartLine":0,"startLine":47,"status":"M"},{"authorDate":"2020-01-30 03:50:52","commitOrder":5,"curCode":"  public void testBufferAggregate()\n  {\n\n    final long[] timestamps = {1526724600L, 1526724700L, 1526724800L, 1526725900L, 1526725000L};\n    final String[] strings = {\"AAAA\", \"BBBB\", \"CCCC\", \"DDDD\", \"EEEE\"};\n    Integer maxStringBytes = 1024;\n\n    TestLongColumnSelector longColumnSelector = new TestLongColumnSelector(timestamps);\n    TestObjectColumnSelector<String> objectColumnSelector = new TestObjectColumnSelector<>(strings);\n\n    StringLastAggregatorFactory factory = new StringLastAggregatorFactory(\n        \"billy\", \"billy\", maxStringBytes\n    );\n\n    StringLastBufferAggregator agg = new StringLastBufferAggregator(\n        longColumnSelector,\n        objectColumnSelector,\n        maxStringBytes,\n        false\n    );\n\n    ByteBuffer buf = ByteBuffer.allocate(factory.getMaxIntermediateSize());\n    int position = 0;\n\n    agg.init(buf, position);\n    \r\n    for (int i = 0; i < timestamps.length; i++) {\n      aggregateBuffer(longColumnSelector, objectColumnSelector, agg, buf, position);\n    }\n\n    SerializablePairLongString sp = ((SerializablePairLongString) agg.get(buf, position));\n\n\n    Assert.assertEquals(\"expected last string value\", \"DDDD\", sp.rhs);\n    Assert.assertEquals(\"last string timestamp is the biggest\", new Long(1526725900L), sp.lhs);\n\n  }\n","date":"2020-01-30 03:50:52","endLine":83,"groupId":"107016","id":10,"instanceNumber":2,"isCurCommit":1,"methodName":"testBufferAggregate","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-druid-10-0.7/blobInfo/CC_OUT/blobs/d4/d17a39bdda94eeee9fb59ca65ecd7a7577c48c.src","preCode":"  public void testBufferAggregate()\n  {\n\n    final long[] timestamps = {1526724600L, 1526724700L, 1526724800L, 1526725900L, 1526725000L};\n    final String[] strings = {\"AAAA\", \"BBBB\", \"CCCC\", \"DDDD\", \"EEEE\"};\n    Integer maxStringBytes = 1024;\n\n    TestLongColumnSelector longColumnSelector = new TestLongColumnSelector(timestamps);\n    TestObjectColumnSelector<String> objectColumnSelector = new TestObjectColumnSelector<>(strings);\n\n    StringLastAggregatorFactory factory = new StringLastAggregatorFactory(\n        \"billy\", \"billy\", maxStringBytes\n    );\n\n    StringLastBufferAggregator agg = new StringLastBufferAggregator(\n        longColumnSelector,\n        objectColumnSelector,\n        maxStringBytes,\n        false\n    );\n\n    ByteBuffer buf = ByteBuffer.allocate(factory.getMaxIntermediateSize());\n    int position = 0;\n\n    agg.init(buf, position);\n    \r\n    for (int i = 0; i < timestamps.length; i++) {\n      aggregateBuffer(longColumnSelector, objectColumnSelector, agg, buf, position);\n    }\n\n    SerializablePairLongString sp = ((SerializablePairLongString) agg.get(buf, position));\n\n\n    Assert.assertEquals(\"expected last string value\", \"DDDD\", sp.rhs);\n    Assert.assertEquals(\"last string timestamp is the biggest\", new Long(1526725900L), new Long(sp.lhs));\n\n  }\n","realPath":"processing/src/test/java/org/apache/druid/query/aggregation/last/StringLastBufferAggregatorTest.java","repoName":"druid","snippetEndLine":0,"snippetStartLine":0,"startLine":47,"status":"M"}],"commitId":"303b02eba16bb639e5adee37cc7ecbab89b00b64","commitMessage":"@@@intelliJ inspections cleanup (#9260)\n\n* intelliJ inspections cleanup\n\n- remove redundant escapes\n- performance warnings\n- access static member via instance reference\n- static method declared final\n- inner class may be static\n\nMost of these changes are aesthetic.  however.  they will allow inspections to\nbe enabled as part of CI checks going forward\n\nThe valuable changes in this delta are:\n- using StringBuilder instead of string addition in a loop\n    indexing-hadoop/.../Utils.java\n    processing/.../ByteBufferMinMaxOffsetHeap.java\n- Use class variables instead of static variables for parameterized test\n    processing/src/.../ScanQueryLimitRowIteratorTest.java\n\n* Add intelliJ inspection warnings as errors to druid profile\n\n* one more static inner class\n","date":"2020-01-30 03:50:52","modifiedFileCount":"43","status":"M","submitter":"Suneet Saldanha"}]
