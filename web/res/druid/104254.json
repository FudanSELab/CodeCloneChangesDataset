[{"authorTime":"2018-08-31 00:56:26","codes":[{"authorDate":"2018-08-31 00:56:26","commitOrder":1,"curCode":"  public void testOneDisableWorkerSameUsedCapacity()\n  {\n    String DISABLED_VERSION = \"\";\n    final EqualDistributionWorkerSelectStrategy strategy = new EqualDistributionWorkerSelectStrategy(null);\n\n    ImmutableWorkerInfo worker = strategy.findWorkerForTask(\n        new RemoteTaskRunnerConfig(),\n        ImmutableMap.of(\n            \"lhost\",\n            new ImmutableWorkerInfo(\n                new Worker(\"http\", \"disableHost\", \"disableHost\", 10, DISABLED_VERSION), 5,\n                Sets.newHashSet(),\n                Sets.newHashSet(),\n                DateTimes.nowUtc()\n            ),\n            \"localhost\",\n            new ImmutableWorkerInfo(\n                new Worker(\"http\", \"enableHost\", \"enableHost\", 10, \"v1\"), 5,\n                Sets.newHashSet(),\n                Sets.newHashSet(),\n                DateTimes.nowUtc()\n            )\n        ),\n        new NoopTask(null, null, 1, 0, null, null, null)\n        {\n          @Override\n          public String getDataSource()\n          {\n            return \"foo\";\n          }\n        }\n    );\n    Assert.assertEquals(\"enableHost\", worker.getWorker().getHost());\n  }\n","date":"2018-08-31 00:56:26","endLine":207,"groupId":"23182","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"testOneDisableWorkerSameUsedCapacity","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-druid-10-0.7/blobInfo/CC_OUT/blobs/0c/1f8b3034c369264534851b4579a3914a9e1985.src","preCode":"  public void testOneDisableWorkerSameUsedCapacity()\n  {\n    String DISABLED_VERSION = \"\";\n    final EqualDistributionWorkerSelectStrategy strategy = new EqualDistributionWorkerSelectStrategy(null);\n\n    ImmutableWorkerInfo worker = strategy.findWorkerForTask(\n        new RemoteTaskRunnerConfig(),\n        ImmutableMap.of(\n            \"lhost\",\n            new ImmutableWorkerInfo(\n                new Worker(\"http\", \"disableHost\", \"disableHost\", 10, DISABLED_VERSION), 5,\n                Sets.newHashSet(),\n                Sets.newHashSet(),\n                DateTimes.nowUtc()\n            ),\n            \"localhost\",\n            new ImmutableWorkerInfo(\n                new Worker(\"http\", \"enableHost\", \"enableHost\", 10, \"v1\"), 5,\n                Sets.newHashSet(),\n                Sets.newHashSet(),\n                DateTimes.nowUtc()\n            )\n        ),\n        new NoopTask(null, null, 1, 0, null, null, null)\n        {\n          @Override\n          public String getDataSource()\n          {\n            return \"foo\";\n          }\n        }\n    );\n    Assert.assertEquals(\"enableHost\", worker.getWorker().getHost());\n  }\n","realPath":"indexing-service/src/test/java/org/apache/druid/indexing/overlord/setup/EqualDistributionWorkerSelectStrategyTest.java","repoName":"druid","snippetEndLine":0,"snippetStartLine":0,"startLine":174,"status":"B"},{"authorDate":"2018-08-31 00:56:26","commitOrder":1,"curCode":"  public void testIsolation()\n  {\n    EqualDistributionWorkerSelectStrategy strategy = new EqualDistributionWithAffinityWorkerSelectStrategy(\n            new AffinityConfig(ImmutableMap.of(\"foo\", ImmutableSet.of(\"localhost\")), false)\n    );\n\n    ImmutableWorkerInfo worker = strategy.findWorkerForTask(\n            new RemoteTaskRunnerConfig(),\n            ImmutableMap.of(\n                    \"localhost\",\n                    new ImmutableWorkerInfo(\n                            new Worker(\"http\", \"localhost\", \"localhost\", 1, \"v1\"), 0,\n                            Sets.newHashSet(),\n                            Sets.newHashSet(),\n                            DateTimes.nowUtc()\n                    )\n            ),\n            new NoopTask(null, null, 1, 0, null, null, null)\n    );\n    Assert.assertNull(worker);\n  }\n","date":"2018-08-31 00:56:26","endLine":140,"groupId":"23182","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"testIsolation","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-druid-10-0.7/blobInfo/CC_OUT/blobs/76/52d1f807ef27e7d22a4071bd2a6a5fe0c3ba23.src","preCode":"  public void testIsolation()\n  {\n    EqualDistributionWorkerSelectStrategy strategy = new EqualDistributionWithAffinityWorkerSelectStrategy(\n            new AffinityConfig(ImmutableMap.of(\"foo\", ImmutableSet.of(\"localhost\")), false)\n    );\n\n    ImmutableWorkerInfo worker = strategy.findWorkerForTask(\n            new RemoteTaskRunnerConfig(),\n            ImmutableMap.of(\n                    \"localhost\",\n                    new ImmutableWorkerInfo(\n                            new Worker(\"http\", \"localhost\", \"localhost\", 1, \"v1\"), 0,\n                            Sets.newHashSet(),\n                            Sets.newHashSet(),\n                            DateTimes.nowUtc()\n                    )\n            ),\n            new NoopTask(null, null, 1, 0, null, null, null)\n    );\n    Assert.assertNull(worker);\n  }\n","realPath":"indexing-service/src/test/java/org/apache/druid/indexing/overlord/setup/EqualDistributionWithAffinityWorkerSelectStrategyTest.java","repoName":"druid","snippetEndLine":0,"snippetStartLine":0,"startLine":120,"status":"B"}],"commitId":"431d3d8497f9079857c3baa7ae7ab4cb44a22355","commitMessage":"@@@Rename io.druid to org.apache.druid. (#6266)\n\n* Rename io.druid to org.apache.druid.\n\n* Fix META-INF files and remove some benchmark results.\n\n* MonitorsConfig update for metrics package migration.\n\n* Reorder some dimensions in inner queries for some reason.\n\n* Fix protobuf tests.\n","date":"2018-08-31 00:56:26","modifiedFileCount":"5","status":"B","submitter":"Gian Merlino"},{"authorTime":"2018-10-29 20:02:43","codes":[{"authorDate":"2018-10-29 20:02:43","commitOrder":2,"curCode":"  public void testOneDisableWorkerSameUsedCapacity()\n  {\n    String DISABLED_VERSION = \"\";\n    final EqualDistributionWorkerSelectStrategy strategy = new EqualDistributionWorkerSelectStrategy(null);\n\n    ImmutableWorkerInfo worker = strategy.findWorkerForTask(\n        new RemoteTaskRunnerConfig(),\n        ImmutableMap.of(\n            \"lhost\",\n            new ImmutableWorkerInfo(\n                new Worker(\"http\", \"disableHost\", \"disableHost\", 10, DISABLED_VERSION), 5,\n                new HashSet<>(),\n                new HashSet<>(),\n                DateTimes.nowUtc()\n            ),\n            \"localhost\",\n            new ImmutableWorkerInfo(\n                new Worker(\"http\", \"enableHost\", \"enableHost\", 10, \"v1\"), 5,\n                new HashSet<>(),\n                new HashSet<>(),\n                DateTimes.nowUtc()\n            )\n        ),\n        new NoopTask(null, null, 1, 0, null, null, null)\n        {\n          @Override\n          public String getDataSource()\n          {\n            return \"foo\";\n          }\n        }\n    );\n    Assert.assertEquals(\"enableHost\", worker.getWorker().getHost());\n  }\n","date":"2018-10-29 20:02:43","endLine":208,"groupId":"5343","id":3,"instanceNumber":1,"isCurCommit":0,"methodName":"testOneDisableWorkerSameUsedCapacity","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-druid-10-0.7/blobInfo/CC_OUT/blobs/e6/8d0a9312a6bfe4ced97ccc0f5a8124e24e8a64.src","preCode":"  public void testOneDisableWorkerSameUsedCapacity()\n  {\n    String DISABLED_VERSION = \"\";\n    final EqualDistributionWorkerSelectStrategy strategy = new EqualDistributionWorkerSelectStrategy(null);\n\n    ImmutableWorkerInfo worker = strategy.findWorkerForTask(\n        new RemoteTaskRunnerConfig(),\n        ImmutableMap.of(\n            \"lhost\",\n            new ImmutableWorkerInfo(\n                new Worker(\"http\", \"disableHost\", \"disableHost\", 10, DISABLED_VERSION), 5,\n                Sets.newHashSet(),\n                Sets.newHashSet(),\n                DateTimes.nowUtc()\n            ),\n            \"localhost\",\n            new ImmutableWorkerInfo(\n                new Worker(\"http\", \"enableHost\", \"enableHost\", 10, \"v1\"), 5,\n                Sets.newHashSet(),\n                Sets.newHashSet(),\n                DateTimes.nowUtc()\n            )\n        ),\n        new NoopTask(null, null, 1, 0, null, null, null)\n        {\n          @Override\n          public String getDataSource()\n          {\n            return \"foo\";\n          }\n        }\n    );\n    Assert.assertEquals(\"enableHost\", worker.getWorker().getHost());\n  }\n","realPath":"indexing-service/src/test/java/org/apache/druid/indexing/overlord/setup/EqualDistributionWorkerSelectStrategyTest.java","repoName":"druid","snippetEndLine":0,"snippetStartLine":0,"startLine":175,"status":"M"},{"authorDate":"2018-10-29 20:02:43","commitOrder":2,"curCode":"  public void testIsolation()\n  {\n    EqualDistributionWorkerSelectStrategy strategy = new EqualDistributionWithAffinityWorkerSelectStrategy(\n            new AffinityConfig(ImmutableMap.of(\"foo\", ImmutableSet.of(\"localhost\")), false)\n    );\n\n    ImmutableWorkerInfo worker = strategy.findWorkerForTask(\n            new RemoteTaskRunnerConfig(),\n            ImmutableMap.of(\n                    \"localhost\",\n                    new ImmutableWorkerInfo(\n                            new Worker(\"http\", \"localhost\", \"localhost\", 1, \"v1\"), 0,\n                            new HashSet<>(),\n                            new HashSet<>(),\n                            DateTimes.nowUtc()\n                    )\n            ),\n            new NoopTask(null, null, 1, 0, null, null, null)\n    );\n    Assert.assertNull(worker);\n  }\n","date":"2018-10-29 20:02:43","endLine":141,"groupId":"5343","id":4,"instanceNumber":2,"isCurCommit":0,"methodName":"testIsolation","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-druid-10-0.7/blobInfo/CC_OUT/blobs/29/294b8ca20c7a78c8738e9e6baf1a0f4b86903f.src","preCode":"  public void testIsolation()\n  {\n    EqualDistributionWorkerSelectStrategy strategy = new EqualDistributionWithAffinityWorkerSelectStrategy(\n            new AffinityConfig(ImmutableMap.of(\"foo\", ImmutableSet.of(\"localhost\")), false)\n    );\n\n    ImmutableWorkerInfo worker = strategy.findWorkerForTask(\n            new RemoteTaskRunnerConfig(),\n            ImmutableMap.of(\n                    \"localhost\",\n                    new ImmutableWorkerInfo(\n                            new Worker(\"http\", \"localhost\", \"localhost\", 1, \"v1\"), 0,\n                            Sets.newHashSet(),\n                            Sets.newHashSet(),\n                            DateTimes.nowUtc()\n                    )\n            ),\n            new NoopTask(null, null, 1, 0, null, null, null)\n    );\n    Assert.assertNull(worker);\n  }\n","realPath":"indexing-service/src/test/java/org/apache/druid/indexing/overlord/setup/EqualDistributionWithAffinityWorkerSelectStrategyTest.java","repoName":"druid","snippetEndLine":0,"snippetStartLine":0,"startLine":121,"status":"M"}],"commitId":"676f5e6d7f184101b8763e4249b18b237bbe0ec7","commitMessage":"@@@Prohibit some guava collection APIs and use JDK collection APIs directly (#6511)\n\n* Prohibit some guava collection APIs and use JDK APIs directly\n\n* reset files that changed by accident\n\n* sort codestyle/druid-forbidden-apis.txt alphabetically\n","date":"2018-10-29 20:02:43","modifiedFileCount":"427","status":"M","submitter":"QiuMM"},{"authorTime":"2018-10-29 20:02:43","codes":[{"authorDate":"2019-05-24 00:40:28","commitOrder":3,"curCode":"  public void testOneDisableWorkerSameUsedCapacity()\n  {\n    String disabledVersion = \"\";\n    final EqualDistributionWorkerSelectStrategy strategy = new EqualDistributionWorkerSelectStrategy(null);\n\n    ImmutableWorkerInfo worker = strategy.findWorkerForTask(\n        new RemoteTaskRunnerConfig(),\n        ImmutableMap.of(\n            \"lhost\",\n            new ImmutableWorkerInfo(\n                new Worker(\"http\", \"disableHost\", \"disableHost\", 10, disabledVersion), 5,\n                new HashSet<>(),\n                new HashSet<>(),\n                DateTimes.nowUtc()\n            ),\n            \"localhost\",\n            new ImmutableWorkerInfo(\n                new Worker(\"http\", \"enableHost\", \"enableHost\", 10, \"v1\"), 5,\n                new HashSet<>(),\n                new HashSet<>(),\n                DateTimes.nowUtc()\n            )\n        ),\n        new NoopTask(null, null, 1, 0, null, null, null)\n        {\n          @Override\n          public String getDataSource()\n          {\n            return \"foo\";\n          }\n        }\n    );\n    Assert.assertEquals(\"enableHost\", worker.getWorker().getHost());\n  }\n","date":"2019-05-24 00:40:28","endLine":208,"groupId":"5343","id":5,"instanceNumber":1,"isCurCommit":0,"methodName":"testOneDisableWorkerSameUsedCapacity","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-druid-10-0.7/blobInfo/CC_OUT/blobs/8d/8e494f598de1f1645121af373dbfdd6d9490e4.src","preCode":"  public void testOneDisableWorkerSameUsedCapacity()\n  {\n    String DISABLED_VERSION = \"\";\n    final EqualDistributionWorkerSelectStrategy strategy = new EqualDistributionWorkerSelectStrategy(null);\n\n    ImmutableWorkerInfo worker = strategy.findWorkerForTask(\n        new RemoteTaskRunnerConfig(),\n        ImmutableMap.of(\n            \"lhost\",\n            new ImmutableWorkerInfo(\n                new Worker(\"http\", \"disableHost\", \"disableHost\", 10, DISABLED_VERSION), 5,\n                new HashSet<>(),\n                new HashSet<>(),\n                DateTimes.nowUtc()\n            ),\n            \"localhost\",\n            new ImmutableWorkerInfo(\n                new Worker(\"http\", \"enableHost\", \"enableHost\", 10, \"v1\"), 5,\n                new HashSet<>(),\n                new HashSet<>(),\n                DateTimes.nowUtc()\n            )\n        ),\n        new NoopTask(null, null, 1, 0, null, null, null)\n        {\n          @Override\n          public String getDataSource()\n          {\n            return \"foo\";\n          }\n        }\n    );\n    Assert.assertEquals(\"enableHost\", worker.getWorker().getHost());\n  }\n","realPath":"indexing-service/src/test/java/org/apache/druid/indexing/overlord/setup/EqualDistributionWorkerSelectStrategyTest.java","repoName":"druid","snippetEndLine":0,"snippetStartLine":0,"startLine":175,"status":"M"},{"authorDate":"2018-10-29 20:02:43","commitOrder":3,"curCode":"  public void testIsolation()\n  {\n    EqualDistributionWorkerSelectStrategy strategy = new EqualDistributionWithAffinityWorkerSelectStrategy(\n            new AffinityConfig(ImmutableMap.of(\"foo\", ImmutableSet.of(\"localhost\")), false)\n    );\n\n    ImmutableWorkerInfo worker = strategy.findWorkerForTask(\n            new RemoteTaskRunnerConfig(),\n            ImmutableMap.of(\n                    \"localhost\",\n                    new ImmutableWorkerInfo(\n                            new Worker(\"http\", \"localhost\", \"localhost\", 1, \"v1\"), 0,\n                            new HashSet<>(),\n                            new HashSet<>(),\n                            DateTimes.nowUtc()\n                    )\n            ),\n            new NoopTask(null, null, 1, 0, null, null, null)\n    );\n    Assert.assertNull(worker);\n  }\n","date":"2018-10-29 20:02:43","endLine":141,"groupId":"5343","id":6,"instanceNumber":2,"isCurCommit":0,"methodName":"testIsolation","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-druid-10-0.7/blobInfo/CC_OUT/blobs/29/294b8ca20c7a78c8738e9e6baf1a0f4b86903f.src","preCode":"  public void testIsolation()\n  {\n    EqualDistributionWorkerSelectStrategy strategy = new EqualDistributionWithAffinityWorkerSelectStrategy(\n            new AffinityConfig(ImmutableMap.of(\"foo\", ImmutableSet.of(\"localhost\")), false)\n    );\n\n    ImmutableWorkerInfo worker = strategy.findWorkerForTask(\n            new RemoteTaskRunnerConfig(),\n            ImmutableMap.of(\n                    \"localhost\",\n                    new ImmutableWorkerInfo(\n                            new Worker(\"http\", \"localhost\", \"localhost\", 1, \"v1\"), 0,\n                            new HashSet<>(),\n                            new HashSet<>(),\n                            DateTimes.nowUtc()\n                    )\n            ),\n            new NoopTask(null, null, 1, 0, null, null, null)\n    );\n    Assert.assertNull(worker);\n  }\n","realPath":"indexing-service/src/test/java/org/apache/druid/indexing/overlord/setup/EqualDistributionWithAffinityWorkerSelectStrategyTest.java","repoName":"druid","snippetEndLine":0,"snippetStartLine":0,"startLine":121,"status":"N"}],"commitId":"26fad7e06a61ae76a670a0ced0690767ed76c6c7","commitMessage":"@@@Add checkstyle for \"Local variable names shouldn't start with capital\" (#7681)\n\n* Add checkstyle for \"Local variable names shouldn't start with capital\"\n\n* Adjust some local variables to constants\n\n* Replace StringUtils.LINE_SEPARATOR with System.lineSeparator()\n","date":"2019-05-24 00:40:28","modifiedFileCount":"13","status":"M","submitter":"Merlin Lee"},{"authorTime":"2019-07-25 08:35:46","codes":[{"authorDate":"2019-07-25 08:35:46","commitOrder":4,"curCode":"  public void testOneDisableWorkerSameUsedCapacity()\n  {\n    String disabledVersion = \"\";\n    final EqualDistributionWorkerSelectStrategy strategy = new EqualDistributionWorkerSelectStrategy(null);\n\n    ImmutableWorkerInfo worker = strategy.findWorkerForTask(\n        new RemoteTaskRunnerConfig(),\n        ImmutableMap.of(\n            \"lhost\",\n            new ImmutableWorkerInfo(\n                new Worker(\"http\", \"disableHost\", \"disableHost\", 10, disabledVersion), 5,\n                new HashSet<>(),\n                new HashSet<>(),\n                DateTimes.nowUtc()\n            ),\n            \"localhost\",\n            new ImmutableWorkerInfo(\n                new Worker(\"http\", \"enableHost\", \"enableHost\", 10, \"v1\"), 5,\n                new HashSet<>(),\n                new HashSet<>(),\n                DateTimes.nowUtc()\n            )\n        ),\n        new NoopTask(null, null, null, 1, 0, null, null, null)\n        {\n          @Override\n          public String getDataSource()\n          {\n            return \"foo\";\n          }\n        }\n    );\n    Assert.assertEquals(\"enableHost\", worker.getWorker().getHost());\n  }\n","date":"2019-07-25 08:35:46","endLine":208,"groupId":"5343","id":7,"instanceNumber":1,"isCurCommit":0,"methodName":"testOneDisableWorkerSameUsedCapacity","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-druid-10-0.7/blobInfo/CC_OUT/blobs/36/02d5b57045bfc8c43d1e0490c0b0666119ebc4.src","preCode":"  public void testOneDisableWorkerSameUsedCapacity()\n  {\n    String disabledVersion = \"\";\n    final EqualDistributionWorkerSelectStrategy strategy = new EqualDistributionWorkerSelectStrategy(null);\n\n    ImmutableWorkerInfo worker = strategy.findWorkerForTask(\n        new RemoteTaskRunnerConfig(),\n        ImmutableMap.of(\n            \"lhost\",\n            new ImmutableWorkerInfo(\n                new Worker(\"http\", \"disableHost\", \"disableHost\", 10, disabledVersion), 5,\n                new HashSet<>(),\n                new HashSet<>(),\n                DateTimes.nowUtc()\n            ),\n            \"localhost\",\n            new ImmutableWorkerInfo(\n                new Worker(\"http\", \"enableHost\", \"enableHost\", 10, \"v1\"), 5,\n                new HashSet<>(),\n                new HashSet<>(),\n                DateTimes.nowUtc()\n            )\n        ),\n        new NoopTask(null, null, 1, 0, null, null, null)\n        {\n          @Override\n          public String getDataSource()\n          {\n            return \"foo\";\n          }\n        }\n    );\n    Assert.assertEquals(\"enableHost\", worker.getWorker().getHost());\n  }\n","realPath":"indexing-service/src/test/java/org/apache/druid/indexing/overlord/setup/EqualDistributionWorkerSelectStrategyTest.java","repoName":"druid","snippetEndLine":0,"snippetStartLine":0,"startLine":175,"status":"M"},{"authorDate":"2019-07-25 08:35:46","commitOrder":4,"curCode":"  public void testIsolation()\n  {\n    EqualDistributionWorkerSelectStrategy strategy = new EqualDistributionWithAffinityWorkerSelectStrategy(\n            new AffinityConfig(ImmutableMap.of(\"foo\", ImmutableSet.of(\"localhost\")), false)\n    );\n\n    ImmutableWorkerInfo worker = strategy.findWorkerForTask(\n            new RemoteTaskRunnerConfig(),\n            ImmutableMap.of(\n                    \"localhost\",\n                    new ImmutableWorkerInfo(\n                            new Worker(\"http\", \"localhost\", \"localhost\", 1, \"v1\"), 0,\n                            new HashSet<>(),\n                            new HashSet<>(),\n                            DateTimes.nowUtc()\n                    )\n            ),\n            new NoopTask(null, null, null, 1, 0, null, null, null)\n    );\n    Assert.assertNull(worker);\n  }\n","date":"2019-07-25 08:35:46","endLine":141,"groupId":"5343","id":8,"instanceNumber":2,"isCurCommit":0,"methodName":"testIsolation","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-druid-10-0.7/blobInfo/CC_OUT/blobs/3c/0bddbce9506b5a5d937911da6a9c28cc905ed2.src","preCode":"  public void testIsolation()\n  {\n    EqualDistributionWorkerSelectStrategy strategy = new EqualDistributionWithAffinityWorkerSelectStrategy(\n            new AffinityConfig(ImmutableMap.of(\"foo\", ImmutableSet.of(\"localhost\")), false)\n    );\n\n    ImmutableWorkerInfo worker = strategy.findWorkerForTask(\n            new RemoteTaskRunnerConfig(),\n            ImmutableMap.of(\n                    \"localhost\",\n                    new ImmutableWorkerInfo(\n                            new Worker(\"http\", \"localhost\", \"localhost\", 1, \"v1\"), 0,\n                            new HashSet<>(),\n                            new HashSet<>(),\n                            DateTimes.nowUtc()\n                    )\n            ),\n            new NoopTask(null, null, 1, 0, null, null, null)\n    );\n    Assert.assertNull(worker);\n  }\n","realPath":"indexing-service/src/test/java/org/apache/druid/indexing/overlord/setup/EqualDistributionWithAffinityWorkerSelectStrategyTest.java","repoName":"druid","snippetEndLine":0,"snippetStartLine":0,"startLine":121,"status":"M"}],"commitId":"db149462073d59e7563f0d3834e69d44a2bb4011","commitMessage":"@@@Add support minor compaction with segment locking (#7547)\n\n* Segment locking\n\n* Allow both timeChunk and segment lock in the same gruop\n\n* fix it test\n\n* Fix adding same chunk to atomicUpdateGroup\n\n* resolving todos\n\n* Fix segments to lock\n\n* fix segments to lock\n\n* fix kill task\n\n* resolving todos\n\n* resolving todos\n\n* fix teamcity\n\n* remove unused class\n\n* fix single map\n\n* resolving todos\n\n* fix build\n\n* fix SQLMetadataSegmentManager\n\n* fix findInputSegments\n\n* adding more tests\n\n* fixing task lock checks\n\n* add SegmentTransactionalOverwriteAction\n\n* changing publisher\n\n* fixing something\n\n* fix for perfect rollup\n\n* fix test\n\n* adjust package-lock.json\n\n* fix test\n\n* fix style\n\n* adding javadocs\n\n* remove unused classes\n\n* add more javadocs\n\n* unused import\n\n* fix test\n\n* fix test\n\n* Support forceTimeChunk context and force timeChunk lock for parallel index task if intervals are missing\n\n* fix travis\n\n* fix travis\n\n* unused import\n\n* spotbug\n\n* revert getMaxVersion\n\n* address comments\n\n* fix tc\n\n* add missing error handling\n\n* fix backward compatibility\n\n* unused import\n\n* Fix perf of versionedIntervalTimeline\n\n* fix timeline\n\n* fix tc\n\n* remove remaining todos\n\n* add comment for parallel index\n\n* fix javadoc and typos\n\n* typo\n\n* address comments\n","date":"2019-07-25 08:35:46","modifiedFileCount":"130","status":"M","submitter":"Jihoon Son"},{"authorTime":"2019-10-18 03:57:19","codes":[{"authorDate":"2019-10-18 03:57:19","commitOrder":5,"curCode":"  public void testOneDisableWorkerSameUsedCapacity()\n  {\n    String disabledVersion = \"\";\n    final EqualDistributionWorkerSelectStrategy strategy = new EqualDistributionWorkerSelectStrategy(null);\n\n    ImmutableWorkerInfo worker = strategy.findWorkerForTask(\n        new RemoteTaskRunnerConfig(),\n        ImmutableMap.of(\n            \"lhost\",\n            new ImmutableWorkerInfo(\n                new Worker(\"http\", \"disableHost\", \"disableHost\", 10, disabledVersion, WorkerConfig.DEFAULT_CATEGORY), 5,\n                new HashSet<>(),\n                new HashSet<>(),\n                DateTimes.nowUtc()\n            ),\n            \"localhost\",\n            new ImmutableWorkerInfo(\n                new Worker(\"http\", \"enableHost\", \"enableHost\", 10, \"v1\", WorkerConfig.DEFAULT_CATEGORY), 5,\n                new HashSet<>(),\n                new HashSet<>(),\n                DateTimes.nowUtc()\n            )\n        ),\n        new NoopTask(null, null, null, 1, 0, null, null, null)\n        {\n          @Override\n          public String getDataSource()\n          {\n            return \"foo\";\n          }\n        }\n    );\n    Assert.assertEquals(\"enableHost\", worker.getWorker().getHost());\n  }\n","date":"2019-10-18 03:57:19","endLine":209,"groupId":"104254","id":9,"instanceNumber":1,"isCurCommit":1,"methodName":"testOneDisableWorkerSameUsedCapacity","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-druid-10-0.7/blobInfo/CC_OUT/blobs/20/259c3a52ed071c3dad8519c23e9898b15388ae.src","preCode":"  public void testOneDisableWorkerSameUsedCapacity()\n  {\n    String disabledVersion = \"\";\n    final EqualDistributionWorkerSelectStrategy strategy = new EqualDistributionWorkerSelectStrategy(null);\n\n    ImmutableWorkerInfo worker = strategy.findWorkerForTask(\n        new RemoteTaskRunnerConfig(),\n        ImmutableMap.of(\n            \"lhost\",\n            new ImmutableWorkerInfo(\n                new Worker(\"http\", \"disableHost\", \"disableHost\", 10, disabledVersion), 5,\n                new HashSet<>(),\n                new HashSet<>(),\n                DateTimes.nowUtc()\n            ),\n            \"localhost\",\n            new ImmutableWorkerInfo(\n                new Worker(\"http\", \"enableHost\", \"enableHost\", 10, \"v1\"), 5,\n                new HashSet<>(),\n                new HashSet<>(),\n                DateTimes.nowUtc()\n            )\n        ),\n        new NoopTask(null, null, null, 1, 0, null, null, null)\n        {\n          @Override\n          public String getDataSource()\n          {\n            return \"foo\";\n          }\n        }\n    );\n    Assert.assertEquals(\"enableHost\", worker.getWorker().getHost());\n  }\n","realPath":"indexing-service/src/test/java/org/apache/druid/indexing/overlord/setup/EqualDistributionWorkerSelectStrategyTest.java","repoName":"druid","snippetEndLine":0,"snippetStartLine":0,"startLine":176,"status":"M"},{"authorDate":"2019-10-18 03:57:19","commitOrder":5,"curCode":"  public void testIsolation()\n  {\n    EqualDistributionWorkerSelectStrategy strategy = new EqualDistributionWithAffinityWorkerSelectStrategy(\n            new AffinityConfig(ImmutableMap.of(\"foo\", ImmutableSet.of(\"localhost\")), false)\n    );\n\n    ImmutableWorkerInfo worker = strategy.findWorkerForTask(\n            new RemoteTaskRunnerConfig(),\n            ImmutableMap.of(\n                    \"localhost\",\n                    new ImmutableWorkerInfo(\n                        new Worker(\"http\", \"localhost\", \"localhost\", 1, \"v1\", WorkerConfig.DEFAULT_CATEGORY), 0,\n                        new HashSet<>(),\n                        new HashSet<>(),\n                        DateTimes.nowUtc()\n                    )\n            ),\n            new NoopTask(null, null, null, 1, 0, null, null, null)\n    );\n    Assert.assertNull(worker);\n  }\n","date":"2019-10-18 03:57:19","endLine":142,"groupId":"104254","id":10,"instanceNumber":2,"isCurCommit":1,"methodName":"testIsolation","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-druid-10-0.7/blobInfo/CC_OUT/blobs/05/d1bd0ed76f9e90c159ac615cbaffd0808a4ae9.src","preCode":"  public void testIsolation()\n  {\n    EqualDistributionWorkerSelectStrategy strategy = new EqualDistributionWithAffinityWorkerSelectStrategy(\n            new AffinityConfig(ImmutableMap.of(\"foo\", ImmutableSet.of(\"localhost\")), false)\n    );\n\n    ImmutableWorkerInfo worker = strategy.findWorkerForTask(\n            new RemoteTaskRunnerConfig(),\n            ImmutableMap.of(\n                    \"localhost\",\n                    new ImmutableWorkerInfo(\n                            new Worker(\"http\", \"localhost\", \"localhost\", 1, \"v1\"), 0,\n                            new HashSet<>(),\n                            new HashSet<>(),\n                            DateTimes.nowUtc()\n                    )\n            ),\n            new NoopTask(null, null, null, 1, 0, null, null, null)\n    );\n    Assert.assertNull(worker);\n  }\n","realPath":"indexing-service/src/test/java/org/apache/druid/indexing/overlord/setup/EqualDistributionWithAffinityWorkerSelectStrategyTest.java","repoName":"druid","snippetEndLine":0,"snippetStartLine":0,"startLine":122,"status":"M"}],"commitId":"2c758ef5ff07891619b7ffedfb28dc31a6850c59","commitMessage":"@@@Support assign tasks to run on different categories of MiddleManagers (#7066)\n\n* Support assign tasks to run on different tiers of MiddleManagers\n\n* address comments\n\n* address comments\n\n* rename tier to category and docs\n\n* doc\n\n* fix doc\n\n* fix spelling errors\n\n* docs\n","date":"2019-10-18 03:57:19","modifiedFileCount":"27","status":"M","submitter":"Mingming Qiu"}]
