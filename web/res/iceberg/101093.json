[{"authorTime":"2020-11-14 09:06:15","codes":[{"authorDate":"2020-11-24 08:29:38","commitOrder":2,"curCode":"  public void testInvalidRewriteManifestsCases() {\n    AssertHelpers.assertThrows(\"Should not allow mixed args\",\n        AnalysisException.class, \"Named and positional arguments cannot be mixed\",\n        () -> sql(\"CALL %s.system.rewrite_manifests('n', table => 't')\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should not resolve procedures in arbitrary namespaces\",\n        NoSuchProcedureException.class, \"not found\",\n        () -> sql(\"CALL %s.custom.rewrite_manifests('n', 't')\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.rewrite_manifests('n')\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls with invalid arg types\",\n        RuntimeException.class, \"Couldn't parse identifier\",\n        () -> sql(\"CALL %s.system.rewrite_manifests('n', 2.2)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject empty namespace\",\n        IllegalArgumentException.class, \"Namespace cannot be empty\",\n        () -> sql(\"CALL %s.system.rewrite_manifests('', 't')\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject empty table name\",\n        IllegalArgumentException.class, \"Table name cannot be empty\",\n        () -> sql(\"CALL %s.system.rewrite_manifests('n', '')\", catalogName));\n  }\n","date":"2020-11-24 08:29:38","endLine":155,"groupId":"184","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"testInvalidRewriteManifestsCases","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/f9/1f9e82a943b11109a7371d356eadc9957c028f.src","preCode":"  public void testInvalidRewriteManifestsCases() {\n    AssertHelpers.assertThrows(\"Should not allow mixed args\",\n        AnalysisException.class, \"Named and positional arguments cannot be mixed\",\n        () -> sql(\"CALL %s.system.rewrite_manifests('n', table => 't')\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should not resolve procedures in arbitrary namespaces\",\n        NoSuchProcedureException.class, \"not found\",\n        () -> sql(\"CALL %s.custom.rewrite_manifests('n', 't')\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.rewrite_manifests('n')\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls with invalid arg types\",\n        RuntimeException.class, \"Couldn't parse identifier\",\n        () -> sql(\"CALL %s.system.rewrite_manifests('n', 2.2)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject empty namespace\",\n        IllegalArgumentException.class, \"Namespace cannot be empty\",\n        () -> sql(\"CALL %s.system.rewrite_manifests('', 't')\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject empty table name\",\n        IllegalArgumentException.class, \"Table name cannot be empty\",\n        () -> sql(\"CALL %s.system.rewrite_manifests('n', '')\", catalogName));\n  }\n","realPath":"spark3-extensions/src/test/java/org/apache/iceberg/spark/extensions/TestRewriteManifestsProcedure.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":131,"status":"B"},{"authorDate":"2020-11-14 09:06:15","commitOrder":2,"curCode":"  public void testInvalidRollbackToSnapshotCases() {\n    AssertHelpers.assertThrows(\"Should not allow mixed args\",\n        AnalysisException.class, \"Named and positional arguments cannot be mixed\",\n        () -> sql(\"CALL %s.system.set_current_snapshot(namespace => 'n1', table => 't', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should not resolve procedures in arbitrary namespaces\",\n        NoSuchProcedureException.class, \"not found\",\n        () -> sql(\"CALL %s.custom.set_current_snapshot('n', 't', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.set_current_snapshot('n', 't')\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.set_current_snapshot('n', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.set_current_snapshot(namespace => 'n', snapshot_id => 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.set_current_snapshot(table => 't', snapshot_id => 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls with invalid arg types\",\n        AnalysisException.class, \"Wrong arg type for snapshot_id: expected LongType\",\n        () -> sql(\"CALL %s.system.set_current_snapshot('n', 't', 2.2)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject empty namespace\",\n        IllegalArgumentException.class, \"Namespace cannot be empty\",\n        () -> sql(\"CALL %s.system.set_current_snapshot('', 't', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject empty table name\",\n        IllegalArgumentException.class, \"Table name cannot be empty\",\n        () -> sql(\"CALL %s.system.set_current_snapshot('n', '', 1L)\", catalogName));\n  }\n","date":"2020-11-14 09:06:15","endLine":224,"groupId":"4511","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"testInvalidRollbackToSnapshotCases","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/7b/8732562fba0c232819f104a8595196a925c14f.src","preCode":"  public void testInvalidRollbackToSnapshotCases() {\n    AssertHelpers.assertThrows(\"Should not allow mixed args\",\n        AnalysisException.class, \"Named and positional arguments cannot be mixed\",\n        () -> sql(\"CALL %s.system.set_current_snapshot(namespace => 'n1', table => 't', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should not resolve procedures in arbitrary namespaces\",\n        NoSuchProcedureException.class, \"not found\",\n        () -> sql(\"CALL %s.custom.set_current_snapshot('n', 't', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.set_current_snapshot('n', 't')\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.set_current_snapshot('n', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.set_current_snapshot(namespace => 'n', snapshot_id => 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.set_current_snapshot(table => 't', snapshot_id => 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls with invalid arg types\",\n        AnalysisException.class, \"Wrong arg type for snapshot_id: expected LongType\",\n        () -> sql(\"CALL %s.system.set_current_snapshot('n', 't', 2.2)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject empty namespace\",\n        IllegalArgumentException.class, \"Namespace cannot be empty\",\n        () -> sql(\"CALL %s.system.set_current_snapshot('', 't', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject empty table name\",\n        IllegalArgumentException.class, \"Table name cannot be empty\",\n        () -> sql(\"CALL %s.system.set_current_snapshot('n', '', 1L)\", catalogName));\n  }\n","realPath":"spark3-extensions/src/test/java/org/apache/iceberg/spark/extensions/TestSetCurrentSnapshotProcedure.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":188,"status":"NB"}],"commitId":"914516f33422b3bfa9955bd0c7d80edbf9054536","commitMessage":"@@@Spark: Add RewriteManifestsProcedure (#1801)\n\n","date":"2020-11-24 08:29:38","modifiedFileCount":"1","status":"M","submitter":"Anton Okolnychyi"},{"authorTime":"2020-12-03 08:34:37","codes":[{"authorDate":"2020-11-24 08:29:38","commitOrder":3,"curCode":"  public void testInvalidRewriteManifestsCases() {\n    AssertHelpers.assertThrows(\"Should not allow mixed args\",\n        AnalysisException.class, \"Named and positional arguments cannot be mixed\",\n        () -> sql(\"CALL %s.system.rewrite_manifests('n', table => 't')\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should not resolve procedures in arbitrary namespaces\",\n        NoSuchProcedureException.class, \"not found\",\n        () -> sql(\"CALL %s.custom.rewrite_manifests('n', 't')\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.rewrite_manifests('n')\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls with invalid arg types\",\n        RuntimeException.class, \"Couldn't parse identifier\",\n        () -> sql(\"CALL %s.system.rewrite_manifests('n', 2.2)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject empty namespace\",\n        IllegalArgumentException.class, \"Namespace cannot be empty\",\n        () -> sql(\"CALL %s.system.rewrite_manifests('', 't')\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject empty table name\",\n        IllegalArgumentException.class, \"Table name cannot be empty\",\n        () -> sql(\"CALL %s.system.rewrite_manifests('n', '')\", catalogName));\n  }\n","date":"2020-11-24 08:29:38","endLine":155,"groupId":"184","id":3,"instanceNumber":1,"isCurCommit":0,"methodName":"testInvalidRewriteManifestsCases","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/f9/1f9e82a943b11109a7371d356eadc9957c028f.src","preCode":"  public void testInvalidRewriteManifestsCases() {\n    AssertHelpers.assertThrows(\"Should not allow mixed args\",\n        AnalysisException.class, \"Named and positional arguments cannot be mixed\",\n        () -> sql(\"CALL %s.system.rewrite_manifests('n', table => 't')\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should not resolve procedures in arbitrary namespaces\",\n        NoSuchProcedureException.class, \"not found\",\n        () -> sql(\"CALL %s.custom.rewrite_manifests('n', 't')\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.rewrite_manifests('n')\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls with invalid arg types\",\n        RuntimeException.class, \"Couldn't parse identifier\",\n        () -> sql(\"CALL %s.system.rewrite_manifests('n', 2.2)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject empty namespace\",\n        IllegalArgumentException.class, \"Namespace cannot be empty\",\n        () -> sql(\"CALL %s.system.rewrite_manifests('', 't')\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject empty table name\",\n        IllegalArgumentException.class, \"Table name cannot be empty\",\n        () -> sql(\"CALL %s.system.rewrite_manifests('n', '')\", catalogName));\n  }\n","realPath":"spark3-extensions/src/test/java/org/apache/iceberg/spark/extensions/TestRewriteManifestsProcedure.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":131,"status":"N"},{"authorDate":"2020-12-03 08:34:37","commitOrder":3,"curCode":"  public void testInvalidRollbackToSnapshotCases() {\n    AssertHelpers.assertThrows(\"Should not allow mixed args\",\n        AnalysisException.class, \"Named and positional arguments cannot be mixed\",\n        () -> sql(\"CALL %s.system.set_current_snapshot(namespace => 'n1', table => 't', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should not resolve procedures in arbitrary namespaces\",\n        NoSuchProcedureException.class, \"not found\",\n        () -> sql(\"CALL %s.custom.set_current_snapshot('n', 't', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.set_current_snapshot('n', 't')\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.set_current_snapshot('n', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.set_current_snapshot(namespace => 'n', snapshot_id => 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.set_current_snapshot(table => 't', snapshot_id => 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls with invalid arg types\",\n        AnalysisException.class, \"Wrong arg type for snapshot_id: cannot cast\",\n        () -> sql(\"CALL %s.system.set_current_snapshot('n', 't', 2.2)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject empty namespace\",\n        IllegalArgumentException.class, \"Namespace cannot be empty\",\n        () -> sql(\"CALL %s.system.set_current_snapshot('', 't', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject empty table name\",\n        IllegalArgumentException.class, \"Table name cannot be empty\",\n        () -> sql(\"CALL %s.system.set_current_snapshot('n', '', 1L)\", catalogName));\n  }\n","date":"2020-12-03 08:34:37","endLine":224,"groupId":"4511","id":4,"instanceNumber":2,"isCurCommit":0,"methodName":"testInvalidRollbackToSnapshotCases","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/c3/1d60df1a5db213926c02328a9ecc52e6481d5c.src","preCode":"  public void testInvalidRollbackToSnapshotCases() {\n    AssertHelpers.assertThrows(\"Should not allow mixed args\",\n        AnalysisException.class, \"Named and positional arguments cannot be mixed\",\n        () -> sql(\"CALL %s.system.set_current_snapshot(namespace => 'n1', table => 't', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should not resolve procedures in arbitrary namespaces\",\n        NoSuchProcedureException.class, \"not found\",\n        () -> sql(\"CALL %s.custom.set_current_snapshot('n', 't', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.set_current_snapshot('n', 't')\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.set_current_snapshot('n', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.set_current_snapshot(namespace => 'n', snapshot_id => 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.set_current_snapshot(table => 't', snapshot_id => 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls with invalid arg types\",\n        AnalysisException.class, \"Wrong arg type for snapshot_id: expected LongType\",\n        () -> sql(\"CALL %s.system.set_current_snapshot('n', 't', 2.2)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject empty namespace\",\n        IllegalArgumentException.class, \"Namespace cannot be empty\",\n        () -> sql(\"CALL %s.system.set_current_snapshot('', 't', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject empty table name\",\n        IllegalArgumentException.class, \"Table name cannot be empty\",\n        () -> sql(\"CALL %s.system.set_current_snapshot('n', '', 1L)\", catalogName));\n  }\n","realPath":"spark3-extensions/src/test/java/org/apache/iceberg/spark/extensions/TestSetCurrentSnapshotProcedure.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":188,"status":"M"}],"commitId":"a4e1cdb2bb595a1257af2fa460216bcdf682977b","commitMessage":"@@@Spark: Fix resolution of procedures with expressions (#1860)\n\n","date":"2020-12-03 08:34:37","modifiedFileCount":"4","status":"M","submitter":"Anton Okolnychyi"},{"authorTime":"2020-12-03 08:34:37","codes":[{"authorDate":"2020-12-05 01:11:11","commitOrder":4,"curCode":"  public void testInvalidRewriteManifestsCases() {\n    AssertHelpers.assertThrows(\"Should not allow mixed args\",\n        AnalysisException.class, \"Named and positional arguments cannot be mixed\",\n        () -> sql(\"CALL %s.system.rewrite_manifests('n', table => 't')\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should not resolve procedures in arbitrary namespaces\",\n        NoSuchProcedureException.class, \"not found\",\n        () -> sql(\"CALL %s.custom.rewrite_manifests('n', 't')\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.rewrite_manifests('n')\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls with invalid arg types\",\n        RuntimeException.class, \"Couldn't parse identifier\",\n        () -> sql(\"CALL %s.system.rewrite_manifests('n', 2.2)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject empty namespace\",\n        IllegalArgumentException.class, \"Namespace cannot be empty\",\n        () -> sql(\"CALL %s.system.rewrite_manifests('', 't')\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject empty table name\",\n        IllegalArgumentException.class, \"Table name cannot be empty\",\n        () -> sql(\"CALL %s.system.rewrite_manifests('n', '')\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject duplicate arg names name\",\n        AnalysisException.class, \"Duplicate procedure argument: table\",\n        () -> sql(\"CALL %s.system.rewrite_manifests(table => 't', tAbLe => 't')\", catalogName));\n  }\n","date":"2020-12-05 01:11:11","endLine":182,"groupId":"184","id":5,"instanceNumber":1,"isCurCommit":0,"methodName":"testInvalidRewriteManifestsCases","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/b1/b30fbcd9e3af88e8da46490b408e65479152c5.src","preCode":"  public void testInvalidRewriteManifestsCases() {\n    AssertHelpers.assertThrows(\"Should not allow mixed args\",\n        AnalysisException.class, \"Named and positional arguments cannot be mixed\",\n        () -> sql(\"CALL %s.system.rewrite_manifests('n', table => 't')\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should not resolve procedures in arbitrary namespaces\",\n        NoSuchProcedureException.class, \"not found\",\n        () -> sql(\"CALL %s.custom.rewrite_manifests('n', 't')\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.rewrite_manifests('n')\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls with invalid arg types\",\n        RuntimeException.class, \"Couldn't parse identifier\",\n        () -> sql(\"CALL %s.system.rewrite_manifests('n', 2.2)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject empty namespace\",\n        IllegalArgumentException.class, \"Namespace cannot be empty\",\n        () -> sql(\"CALL %s.system.rewrite_manifests('', 't')\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject empty table name\",\n        IllegalArgumentException.class, \"Table name cannot be empty\",\n        () -> sql(\"CALL %s.system.rewrite_manifests('n', '')\", catalogName));\n  }\n","realPath":"spark3-extensions/src/test/java/org/apache/iceberg/spark/extensions/TestRewriteManifestsProcedure.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":154,"status":"M"},{"authorDate":"2020-12-03 08:34:37","commitOrder":4,"curCode":"  public void testInvalidRollbackToSnapshotCases() {\n    AssertHelpers.assertThrows(\"Should not allow mixed args\",\n        AnalysisException.class, \"Named and positional arguments cannot be mixed\",\n        () -> sql(\"CALL %s.system.set_current_snapshot(namespace => 'n1', table => 't', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should not resolve procedures in arbitrary namespaces\",\n        NoSuchProcedureException.class, \"not found\",\n        () -> sql(\"CALL %s.custom.set_current_snapshot('n', 't', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.set_current_snapshot('n', 't')\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.set_current_snapshot('n', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.set_current_snapshot(namespace => 'n', snapshot_id => 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.set_current_snapshot(table => 't', snapshot_id => 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls with invalid arg types\",\n        AnalysisException.class, \"Wrong arg type for snapshot_id: cannot cast\",\n        () -> sql(\"CALL %s.system.set_current_snapshot('n', 't', 2.2)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject empty namespace\",\n        IllegalArgumentException.class, \"Namespace cannot be empty\",\n        () -> sql(\"CALL %s.system.set_current_snapshot('', 't', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject empty table name\",\n        IllegalArgumentException.class, \"Table name cannot be empty\",\n        () -> sql(\"CALL %s.system.set_current_snapshot('n', '', 1L)\", catalogName));\n  }\n","date":"2020-12-03 08:34:37","endLine":224,"groupId":"4511","id":6,"instanceNumber":2,"isCurCommit":0,"methodName":"testInvalidRollbackToSnapshotCases","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/c3/1d60df1a5db213926c02328a9ecc52e6481d5c.src","preCode":"  public void testInvalidRollbackToSnapshotCases() {\n    AssertHelpers.assertThrows(\"Should not allow mixed args\",\n        AnalysisException.class, \"Named and positional arguments cannot be mixed\",\n        () -> sql(\"CALL %s.system.set_current_snapshot(namespace => 'n1', table => 't', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should not resolve procedures in arbitrary namespaces\",\n        NoSuchProcedureException.class, \"not found\",\n        () -> sql(\"CALL %s.custom.set_current_snapshot('n', 't', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.set_current_snapshot('n', 't')\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.set_current_snapshot('n', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.set_current_snapshot(namespace => 'n', snapshot_id => 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.set_current_snapshot(table => 't', snapshot_id => 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls with invalid arg types\",\n        AnalysisException.class, \"Wrong arg type for snapshot_id: cannot cast\",\n        () -> sql(\"CALL %s.system.set_current_snapshot('n', 't', 2.2)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject empty namespace\",\n        IllegalArgumentException.class, \"Namespace cannot be empty\",\n        () -> sql(\"CALL %s.system.set_current_snapshot('', 't', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject empty table name\",\n        IllegalArgumentException.class, \"Table name cannot be empty\",\n        () -> sql(\"CALL %s.system.set_current_snapshot('n', '', 1L)\", catalogName));\n  }\n","realPath":"spark3-extensions/src/test/java/org/apache/iceberg/spark/extensions/TestSetCurrentSnapshotProcedure.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":188,"status":"N"}],"commitId":"7d7a51dcc3448be0cbcbb620c85d9505fbcb2654","commitMessage":"@@@Spark: Make procedure param resolution case insensitive (#1866)\n\n","date":"2020-12-05 01:11:11","modifiedFileCount":"1","status":"M","submitter":"Anton Okolnychyi"},{"authorTime":"2020-12-09 23:37:55","codes":[{"authorDate":"2020-12-09 23:37:55","commitOrder":5,"curCode":"  public void testInvalidRewriteManifestsCases() {\n    AssertHelpers.assertThrows(\"Should not allow mixed args\",\n        AnalysisException.class, \"Named and positional arguments cannot be mixed\",\n        () -> sql(\"CALL %s.system.rewrite_manifests('n', table => 't')\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should not resolve procedures in arbitrary namespaces\",\n        NoSuchProcedureException.class, \"not found\",\n        () -> sql(\"CALL %s.custom.rewrite_manifests('n', 't')\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.rewrite_manifests()\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls with invalid arg types\",\n        AnalysisException.class, \"Wrong arg type\",\n        () -> sql(\"CALL %s.system.rewrite_manifests('n', 2.2)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject duplicate arg names name\",\n        AnalysisException.class, \"Duplicate procedure argument: table\",\n        () -> sql(\"CALL %s.system.rewrite_manifests(table => 't', tAbLe => 't')\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls with empty table identifier\",\n        IllegalArgumentException.class, \"Cannot handle an empty identifier\",\n        () -> sql(\"CALL %s.system.rewrite_manifests('')\", catalogName));\n  }\n","date":"2020-12-09 23:37:55","endLine":173,"groupId":"101093","id":7,"instanceNumber":1,"isCurCommit":1,"methodName":"testInvalidRewriteManifestsCases","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/b0/4f17693e3ac0f4f87d3f12e98e9ecc6ce5ef5c.src","preCode":"  public void testInvalidRewriteManifestsCases() {\n    AssertHelpers.assertThrows(\"Should not allow mixed args\",\n        AnalysisException.class, \"Named and positional arguments cannot be mixed\",\n        () -> sql(\"CALL %s.system.rewrite_manifests('n', table => 't')\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should not resolve procedures in arbitrary namespaces\",\n        NoSuchProcedureException.class, \"not found\",\n        () -> sql(\"CALL %s.custom.rewrite_manifests('n', 't')\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.rewrite_manifests('n')\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls with invalid arg types\",\n        RuntimeException.class, \"Couldn't parse identifier\",\n        () -> sql(\"CALL %s.system.rewrite_manifests('n', 2.2)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject empty namespace\",\n        IllegalArgumentException.class, \"Namespace cannot be empty\",\n        () -> sql(\"CALL %s.system.rewrite_manifests('', 't')\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject empty table name\",\n        IllegalArgumentException.class, \"Table name cannot be empty\",\n        () -> sql(\"CALL %s.system.rewrite_manifests('n', '')\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject duplicate arg names name\",\n        AnalysisException.class, \"Duplicate procedure argument: table\",\n        () -> sql(\"CALL %s.system.rewrite_manifests(table => 't', tAbLe => 't')\", catalogName));\n  }\n","realPath":"spark3-extensions/src/test/java/org/apache/iceberg/spark/extensions/TestRewriteManifestsProcedure.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":149,"status":"M"},{"authorDate":"2020-12-09 23:37:55","commitOrder":5,"curCode":"  public void testInvalidRollbackToSnapshotCases() {\n    AssertHelpers.assertThrows(\"Should not allow mixed args\",\n        AnalysisException.class, \"Named and positional arguments cannot be mixed\",\n        () -> sql(\"CALL %s.system.set_current_snapshot(namespace => 'n1', table => 't', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should not resolve procedures in arbitrary namespaces\",\n        NoSuchProcedureException.class, \"not found\",\n        () -> sql(\"CALL %s.custom.set_current_snapshot('n', 't', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.set_current_snapshot('t')\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.set_current_snapshot(1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.set_current_snapshot(snapshot_id => 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.set_current_snapshot(table => 't')\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls with invalid arg types\",\n        AnalysisException.class, \"Wrong arg type for snapshot_id: cannot cast\",\n        () -> sql(\"CALL %s.system.set_current_snapshot('t', 2.2)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls with empty table identifier\",\n        IllegalArgumentException.class, \"Cannot handle an empty identifier\",\n        () -> sql(\"CALL %s.system.set_current_snapshot('', 1L)\", catalogName));\n  }\n","date":"2020-12-09 23:37:55","endLine":220,"groupId":"101093","id":8,"instanceNumber":2,"isCurCommit":1,"methodName":"testInvalidRollbackToSnapshotCases","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-iceberg-10-0.7/blobInfo/CC_OUT/blobs/0e/a8c4861e8c4bd61fdd3a41f6aaee5dfba0ca3c.src","preCode":"  public void testInvalidRollbackToSnapshotCases() {\n    AssertHelpers.assertThrows(\"Should not allow mixed args\",\n        AnalysisException.class, \"Named and positional arguments cannot be mixed\",\n        () -> sql(\"CALL %s.system.set_current_snapshot(namespace => 'n1', table => 't', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should not resolve procedures in arbitrary namespaces\",\n        NoSuchProcedureException.class, \"not found\",\n        () -> sql(\"CALL %s.custom.set_current_snapshot('n', 't', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.set_current_snapshot('n', 't')\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.set_current_snapshot('n', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.set_current_snapshot(namespace => 'n', snapshot_id => 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls without all required args\",\n        AnalysisException.class, \"Missing required parameters\",\n        () -> sql(\"CALL %s.system.set_current_snapshot(table => 't', snapshot_id => 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject calls with invalid arg types\",\n        AnalysisException.class, \"Wrong arg type for snapshot_id: cannot cast\",\n        () -> sql(\"CALL %s.system.set_current_snapshot('n', 't', 2.2)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject empty namespace\",\n        IllegalArgumentException.class, \"Namespace cannot be empty\",\n        () -> sql(\"CALL %s.system.set_current_snapshot('', 't', 1L)\", catalogName));\n\n    AssertHelpers.assertThrows(\"Should reject empty table name\",\n        IllegalArgumentException.class, \"Table name cannot be empty\",\n        () -> sql(\"CALL %s.system.set_current_snapshot('n', '', 1L)\", catalogName));\n  }\n","realPath":"spark3-extensions/src/test/java/org/apache/iceberg/spark/extensions/TestSetCurrentSnapshotProcedure.java","repoName":"iceberg","snippetEndLine":0,"snippetStartLine":0,"startLine":188,"status":"M"}],"commitId":"e39584ed89356cacf006610bffd475a3ad3a1ac4","commitMessage":"@@@Spark: Migrate to identifiers in procedures (#1890)\n\n","date":"2020-12-09 23:37:55","modifiedFileCount":"16","status":"M","submitter":"Russell Spitzer"}]
