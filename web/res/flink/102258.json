[{"authorTime":"2016-12-10 01:41:36","codes":[{"authorDate":"2016-12-10 01:41:36","commitOrder":1,"curCode":"\tpublic void testReadFirstN() throws Exception {\n\t\tString fileContent = \"111|222|333|444|555|\\n666|777|888|999|000|\\n\";\n\n\t\tFileInputSplit split = createTempFile(fileContent);\n\n\t\tRowTypeInfo typeInfo = new RowTypeInfo(\n\t\t\tBasicTypeInfo.INT_TYPE_INFO,\n\t\t\tBasicTypeInfo.INT_TYPE_INFO);\n\n\t\tRowCsvInputFormat format = new RowCsvInputFormat(PATH, typeInfo);\n\t\tformat.setFieldDelimiter(\"|\");\n\t\tformat.configure(new Configuration());\n\t\tformat.open(split);\n\n\t\tRow result = new Row(2);\n\n\t\tresult = format.nextRecord(result);\n\t\tassertNotNull(result);\n\t\tassertEquals(111, result.getField(0));\n\t\tassertEquals(222, result.getField(1));\n\n\t\tresult = format.nextRecord(result);\n\t\tassertNotNull(result);\n\t\tassertEquals(666, result.getField(0));\n\t\tassertEquals(777, result.getField(1));\n\n\t\tresult = format.nextRecord(result);\n\t\tassertNull(result);\n\t\tassertTrue(format.reachedEnd());\n\t}\n","date":"2016-12-15 18:36:40","endLine":507,"groupId":"2685","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"testReadFirstN","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-flink-10-0.7/blobInfo/CC_OUT/blobs/a6/8e81ee839a623e584cfc0ed94f51d8ace5d0a9.src","preCode":"\tpublic void testReadFirstN() throws Exception {\n\t\tString fileContent = \"111|222|333|444|555|\\n666|777|888|999|000|\\n\";\n\n\t\tFileInputSplit split = createTempFile(fileContent);\n\n\t\tRowTypeInfo typeInfo = new RowTypeInfo(\n\t\t\tBasicTypeInfo.INT_TYPE_INFO,\n\t\t\tBasicTypeInfo.INT_TYPE_INFO);\n\n\t\tRowCsvInputFormat format = new RowCsvInputFormat(PATH, typeInfo);\n\t\tformat.setFieldDelimiter(\"|\");\n\t\tformat.configure(new Configuration());\n\t\tformat.open(split);\n\n\t\tRow result = new Row(2);\n\n\t\tresult = format.nextRecord(result);\n\t\tassertNotNull(result);\n\t\tassertEquals(111, result.getField(0));\n\t\tassertEquals(222, result.getField(1));\n\n\t\tresult = format.nextRecord(result);\n\t\tassertNotNull(result);\n\t\tassertEquals(666, result.getField(0));\n\t\tassertEquals(777, result.getField(1));\n\n\t\tresult = format.nextRecord(result);\n\t\tassertNull(result);\n\t\tassertTrue(format.reachedEnd());\n\t}\n","realPath":"flink-java/src/test/java/org/apache/flink/api/java/io/RowCsvInputFormatTest.java","repoName":"flink","snippetEndLine":0,"snippetStartLine":0,"startLine":478,"status":"B"},{"authorDate":"2016-12-10 01:41:36","commitOrder":1,"curCode":"\tpublic void testReadSparseWithNullFieldsForTypes() throws Exception {\n\t\tString fileContent = \"111|x|222|x|333|x|444|x|555|x|666|x|777|x|888|x|999|x|000|x|\\n\" +\n\t\t\t\"000|x|999|x|888|x|777|x|666|x|555|x|444|x|333|x|222|x|111|x|\";\n\n\t\tFileInputSplit split = createTempFile(fileContent);\n\n\t\tRowTypeInfo typeInfo = new RowTypeInfo(\n\t\t\tBasicTypeInfo.INT_TYPE_INFO,\n\t\t\tBasicTypeInfo.INT_TYPE_INFO,\n\t\t\tBasicTypeInfo.INT_TYPE_INFO);\n\n\t\tRowCsvInputFormat format = new RowCsvInputFormat(\n\t\t\tPATH,\n\t\t\ttypeInfo,\n\t\t\tnew boolean[]{true, false, false, true, false, false, false, true});\n\t\tformat.setFieldDelimiter(\"|x|\");\n\t\tformat.configure(new Configuration());\n\t\tformat.open(split);\n\n\t\tRow result = new Row(3);\n\n\t\tresult = format.nextRecord(result);\n\t\tassertNotNull(result);\n\t\tassertEquals(111, result.getField(0));\n\t\tassertEquals(444, result.getField(1));\n\t\tassertEquals(888, result.getField(2));\n\n\t\tresult = format.nextRecord(result);\n\t\tassertNotNull(result);\n\t\tassertEquals(0, result.getField(0));\n\t\tassertEquals(777, result.getField(1));\n\t\tassertEquals(333, result.getField(2));\n\n\t\tresult = format.nextRecord(result);\n\t\tassertNull(result);\n\t\tassertTrue(format.reachedEnd());\n\t}\n","date":"2016-12-15 18:36:40","endLine":546,"groupId":"30017","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"testReadSparseWithNullFieldsForTypes","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-flink-10-0.7/blobInfo/CC_OUT/blobs/a6/8e81ee839a623e584cfc0ed94f51d8ace5d0a9.src","preCode":"\tpublic void testReadSparseWithNullFieldsForTypes() throws Exception {\n\t\tString fileContent = \"111|x|222|x|333|x|444|x|555|x|666|x|777|x|888|x|999|x|000|x|\\n\" +\n\t\t\t\"000|x|999|x|888|x|777|x|666|x|555|x|444|x|333|x|222|x|111|x|\";\n\n\t\tFileInputSplit split = createTempFile(fileContent);\n\n\t\tRowTypeInfo typeInfo = new RowTypeInfo(\n\t\t\tBasicTypeInfo.INT_TYPE_INFO,\n\t\t\tBasicTypeInfo.INT_TYPE_INFO,\n\t\t\tBasicTypeInfo.INT_TYPE_INFO);\n\n\t\tRowCsvInputFormat format = new RowCsvInputFormat(\n\t\t\tPATH,\n\t\t\ttypeInfo,\n\t\t\tnew boolean[]{true, false, false, true, false, false, false, true});\n\t\tformat.setFieldDelimiter(\"|x|\");\n\t\tformat.configure(new Configuration());\n\t\tformat.open(split);\n\n\t\tRow result = new Row(3);\n\n\t\tresult = format.nextRecord(result);\n\t\tassertNotNull(result);\n\t\tassertEquals(111, result.getField(0));\n\t\tassertEquals(444, result.getField(1));\n\t\tassertEquals(888, result.getField(2));\n\n\t\tresult = format.nextRecord(result);\n\t\tassertNotNull(result);\n\t\tassertEquals(0, result.getField(0));\n\t\tassertEquals(777, result.getField(1));\n\t\tassertEquals(333, result.getField(2));\n\n\t\tresult = format.nextRecord(result);\n\t\tassertNull(result);\n\t\tassertTrue(format.reachedEnd());\n\t}\n","realPath":"flink-java/src/test/java/org/apache/flink/api/java/io/RowCsvInputFormatTest.java","repoName":"flink","snippetEndLine":0,"snippetStartLine":0,"startLine":510,"status":"B"}],"commitId":"4d27f8f2deef9fad845ebc91cef121cf9b35f825","commitMessage":"@@@[FLINK-5188] [table] [connectors] [core] Adjust imports and method calls to new Row type.\n\n- Port RowCsvInputFormat to Java and move it to flink-core.\n\nThis closes #3003.\n","date":"2016-12-15 18:36:40","modifiedFileCount":"35","status":"B","submitter":"tonycox"},{"authorTime":"2016-12-08 16:00:40","codes":[{"authorDate":"2016-12-08 16:00:40","commitOrder":2,"curCode":"\tpublic void testReadFirstN() throws Exception {\n\t\tString fileContent = \"111|222|333|444|555|\\n666|777|888|999|000|\\n\";\n\n\t\tFileInputSplit split = createTempFile(fileContent);\n\n\t\tTypeInformation[] fieldTypes = new TypeInformation[]{\n\t\t\tBasicTypeInfo.INT_TYPE_INFO,\n\t\t\tBasicTypeInfo.INT_TYPE_INFO};\n\n\t\tRowCsvInputFormat format = new RowCsvInputFormat(PATH, fieldTypes);\n\t\tformat.setFieldDelimiter(\"|\");\n\t\tformat.configure(new Configuration());\n\t\tformat.open(split);\n\n\t\tRow result = new Row(2);\n\n\t\tresult = format.nextRecord(result);\n\t\tassertNotNull(result);\n\t\tassertEquals(111, result.getField(0));\n\t\tassertEquals(222, result.getField(1));\n\n\t\tresult = format.nextRecord(result);\n\t\tassertNotNull(result);\n\t\tassertEquals(666, result.getField(0));\n\t\tassertEquals(777, result.getField(1));\n\n\t\tresult = format.nextRecord(result);\n\t\tassertNull(result);\n\t\tassertTrue(format.reachedEnd());\n\t}\n","date":"2016-12-16 23:41:21","endLine":508,"groupId":"102258","id":3,"instanceNumber":1,"isCurCommit":0,"methodName":"testReadFirstN","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-flink-10-0.7/blobInfo/CC_OUT/blobs/b8/19641c8f09fd05bd471919ed81bcc56ea12ee7.src","preCode":"\tpublic void testReadFirstN() throws Exception {\n\t\tString fileContent = \"111|222|333|444|555|\\n666|777|888|999|000|\\n\";\n\n\t\tFileInputSplit split = createTempFile(fileContent);\n\n\t\tRowTypeInfo typeInfo = new RowTypeInfo(\n\t\t\tBasicTypeInfo.INT_TYPE_INFO,\n\t\t\tBasicTypeInfo.INT_TYPE_INFO);\n\n\t\tRowCsvInputFormat format = new RowCsvInputFormat(PATH, typeInfo);\n\t\tformat.setFieldDelimiter(\"|\");\n\t\tformat.configure(new Configuration());\n\t\tformat.open(split);\n\n\t\tRow result = new Row(2);\n\n\t\tresult = format.nextRecord(result);\n\t\tassertNotNull(result);\n\t\tassertEquals(111, result.getField(0));\n\t\tassertEquals(222, result.getField(1));\n\n\t\tresult = format.nextRecord(result);\n\t\tassertNotNull(result);\n\t\tassertEquals(666, result.getField(0));\n\t\tassertEquals(777, result.getField(1));\n\n\t\tresult = format.nextRecord(result);\n\t\tassertNull(result);\n\t\tassertTrue(format.reachedEnd());\n\t}\n","realPath":"flink-java/src/test/java/org/apache/flink/api/java/io/RowCsvInputFormatTest.java","repoName":"flink","snippetEndLine":0,"snippetStartLine":0,"startLine":479,"status":"M"},{"authorDate":"2016-12-08 16:00:40","commitOrder":2,"curCode":"\tpublic void testReadSparseWithNullFieldsForTypes() throws Exception {\n\t\tString fileContent = \"111|x|222|x|333|x|444|x|555|x|666|x|777|x|888|x|999|x|000|x|\\n\" +\n\t\t\t\"000|x|999|x|888|x|777|x|666|x|555|x|444|x|333|x|222|x|111|x|\";\n\n\t\tFileInputSplit split = createTempFile(fileContent);\n\n\t\tTypeInformation[] fieldTypes = new TypeInformation[]{\n\t\t\tBasicTypeInfo.INT_TYPE_INFO,\n\t\t\tBasicTypeInfo.INT_TYPE_INFO,\n\t\t\tBasicTypeInfo.INT_TYPE_INFO};\n\n\t\tRowCsvInputFormat format = new RowCsvInputFormat(\n\t\t\tPATH,\n\t\t\tfieldTypes,\n\t\t\tnew int[]{0,3,7});\n\t\tformat.setFieldDelimiter(\"|x|\");\n\t\tformat.configure(new Configuration());\n\t\tformat.open(split);\n\n\t\tRow result = new Row(3);\n\n\t\tresult = format.nextRecord(result);\n\t\tassertNotNull(result);\n\t\tassertEquals(111, result.getField(0));\n\t\tassertEquals(444, result.getField(1));\n\t\tassertEquals(888, result.getField(2));\n\n\t\tresult = format.nextRecord(result);\n\t\tassertNotNull(result);\n\t\tassertEquals(0, result.getField(0));\n\t\tassertEquals(777, result.getField(1));\n\t\tassertEquals(333, result.getField(2));\n\n\t\tresult = format.nextRecord(result);\n\t\tassertNull(result);\n\t\tassertTrue(format.reachedEnd());\n\t}\n","date":"2016-12-16 23:41:21","endLine":547,"groupId":"102258","id":4,"instanceNumber":2,"isCurCommit":0,"methodName":"testReadSparseWithNullFieldsForTypes","params":"()","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-flink-10-0.7/blobInfo/CC_OUT/blobs/b8/19641c8f09fd05bd471919ed81bcc56ea12ee7.src","preCode":"\tpublic void testReadSparseWithNullFieldsForTypes() throws Exception {\n\t\tString fileContent = \"111|x|222|x|333|x|444|x|555|x|666|x|777|x|888|x|999|x|000|x|\\n\" +\n\t\t\t\"000|x|999|x|888|x|777|x|666|x|555|x|444|x|333|x|222|x|111|x|\";\n\n\t\tFileInputSplit split = createTempFile(fileContent);\n\n\t\tRowTypeInfo typeInfo = new RowTypeInfo(\n\t\t\tBasicTypeInfo.INT_TYPE_INFO,\n\t\t\tBasicTypeInfo.INT_TYPE_INFO,\n\t\t\tBasicTypeInfo.INT_TYPE_INFO);\n\n\t\tRowCsvInputFormat format = new RowCsvInputFormat(\n\t\t\tPATH,\n\t\t\ttypeInfo,\n\t\t\tnew boolean[]{true, false, false, true, false, false, false, true});\n\t\tformat.setFieldDelimiter(\"|x|\");\n\t\tformat.configure(new Configuration());\n\t\tformat.open(split);\n\n\t\tRow result = new Row(3);\n\n\t\tresult = format.nextRecord(result);\n\t\tassertNotNull(result);\n\t\tassertEquals(111, result.getField(0));\n\t\tassertEquals(444, result.getField(1));\n\t\tassertEquals(888, result.getField(2));\n\n\t\tresult = format.nextRecord(result);\n\t\tassertNotNull(result);\n\t\tassertEquals(0, result.getField(0));\n\t\tassertEquals(777, result.getField(1));\n\t\tassertEquals(333, result.getField(2));\n\n\t\tresult = format.nextRecord(result);\n\t\tassertNull(result);\n\t\tassertTrue(format.reachedEnd());\n\t}\n","realPath":"flink-java/src/test/java/org/apache/flink/api/java/io/RowCsvInputFormatTest.java","repoName":"flink","snippetEndLine":0,"snippetStartLine":0,"startLine":511,"status":"M"}],"commitId":"ef575e87e8a77d56673d40d98d3d66c6511d57ab","commitMessage":"@@@[FLINK-3848] [table] Add projection push down for StreamTableSource.\n\n- Add plan tests for projection push down.\n- Implement ProjectableTableSource in CsvTableSource.\n- Refactored RowCsvInputFormat\n\nThis closes #2810.\n","date":"2016-12-16 23:41:21","modifiedFileCount":"2","status":"M","submitter":"tonycox"}]
