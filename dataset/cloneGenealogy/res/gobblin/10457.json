[{"authorTime":"2017-07-31 15:51:25","codes":[{"authorDate":"2017-07-31 15:51:25","commitOrder":1,"curCode":"  public Schema getLatestSchema(String topic) throws SchemaRegistryException {\n    String schemaUrl = this.url + GET_RESOURCE_BY_TYPE + topic;\n\n    LOG.debug(\"Fetching from URL : \" + schemaUrl);\n\n    GetMethod get = new GetMethod(schemaUrl);\n\n    int statusCode;\n    String schemaString;\n    HttpClient httpClient = this.borrowClient();\n    try {\n      statusCode = httpClient.executeMethod(get);\n      schemaString = get.getResponseBodyAsString();\n    } catch (HttpException e) {\n      throw new RuntimeException(e);\n    } catch (IOException e) {\n      throw new RuntimeException(e);\n    } finally {\n      get.releaseConnection();\n      this.httpClientPool.returnObject(httpClient);\n    }\n\n    if (statusCode != HttpStatus.SC_OK) {\n      throw new SchemaRegistryException(\n          String.format(\"Latest schema for topic %s cannot be retrieved. Status code = %d\", topic, statusCode));\n    }\n\n    Schema schema;\n    try {\n      schema = new Schema.Parser().parse(schemaString);\n    } catch (Throwable t) {\n      throw new SchemaRegistryException(String.format(\"Latest schema for topic %s cannot be retrieved\", topic), t);\n    }\n\n    return schema;\n  }\n","date":"2017-07-31 15:51:25","endLine":138,"groupId":"376","id":1,"instanceNumber":1,"isCurCommit":0,"methodName":"getLatestSchema","params":"(Stringtopic)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-gobblin-10-0.7/blobInfo/CC_OUT/blobs/2e/a70757aefabe532ba6b279d0e40e9c0816af8d.src","preCode":"  public Schema getLatestSchema(String topic) throws SchemaRegistryException {\n    String schemaUrl = this.url + GET_RESOURCE_BY_TYPE + topic;\n\n    LOG.debug(\"Fetching from URL : \" + schemaUrl);\n\n    GetMethod get = new GetMethod(schemaUrl);\n\n    int statusCode;\n    String schemaString;\n    HttpClient httpClient = this.borrowClient();\n    try {\n      statusCode = httpClient.executeMethod(get);\n      schemaString = get.getResponseBodyAsString();\n    } catch (HttpException e) {\n      throw new RuntimeException(e);\n    } catch (IOException e) {\n      throw new RuntimeException(e);\n    } finally {\n      get.releaseConnection();\n      this.httpClientPool.returnObject(httpClient);\n    }\n\n    if (statusCode != HttpStatus.SC_OK) {\n      throw new SchemaRegistryException(\n          String.format(\"Latest schema for topic %s cannot be retrieved. Status code = %d\", topic, statusCode));\n    }\n\n    Schema schema;\n    try {\n      schema = new Schema.Parser().parse(schemaString);\n    } catch (Throwable t) {\n      throw new SchemaRegistryException(String.format(\"Latest schema for topic %s cannot be retrieved\", topic), t);\n    }\n\n    return schema;\n  }\n","realPath":"gobblin-modules/gobblin-kafka-common/src/main/java/org/apache/gobblin/kafka/schemareg/LiKafkaSchemaRegistry.java","repoName":"gobblin","snippetEndLine":0,"snippetStartLine":0,"startLine":103,"status":"B"},{"authorDate":"2017-07-31 15:51:25","commitOrder":1,"curCode":"  public Schema getLatestSchemaByTopic(String topic) throws SchemaRegistryException {\n    String schemaUrl = KafkaAvroSchemaRegistry.this.url + GET_RESOURCE_BY_TYPE + topic;\n\n    LOG.debug(\"Fetching from URL : \" + schemaUrl);\n\n    GetMethod get = new GetMethod(schemaUrl);\n\n    int statusCode;\n    String schemaString;\n    HttpClient httpClient = this.borrowClient();\n    try {\n      statusCode = httpClient.executeMethod(get);\n      schemaString = get.getResponseBodyAsString();\n    } catch (HttpException e) {\n      throw new RuntimeException(e);\n    } catch (IOException e) {\n      throw new RuntimeException(e);\n    } finally {\n      get.releaseConnection();\n      this.httpClientPool.returnObject(httpClient);\n    }\n\n    if (statusCode != HttpStatus.SC_OK) {\n      throw new SchemaRegistryException(\n          String.format(\"Latest schema for topic %s cannot be retrieved. Status code = %d\", topic, statusCode));\n    }\n\n    Schema schema;\n    try {\n      schema = new Schema.Parser().parse(schemaString);\n    } catch (Throwable t) {\n      throw new SchemaRegistryException(String.format(\"Latest schema for topic %s cannot be retrieved\", topic), t);\n    }\n\n    return schema;\n  }\n","date":"2017-07-31 15:51:25","endLine":152,"groupId":"376","id":2,"instanceNumber":2,"isCurCommit":0,"methodName":"getLatestSchemaByTopic","params":"(Stringtopic)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-gobblin-10-0.7/blobInfo/CC_OUT/blobs/d3/91ef3e07eacf7165a649f79deba5984d631136.src","preCode":"  public Schema getLatestSchemaByTopic(String topic) throws SchemaRegistryException {\n    String schemaUrl = KafkaAvroSchemaRegistry.this.url + GET_RESOURCE_BY_TYPE + topic;\n\n    LOG.debug(\"Fetching from URL : \" + schemaUrl);\n\n    GetMethod get = new GetMethod(schemaUrl);\n\n    int statusCode;\n    String schemaString;\n    HttpClient httpClient = this.borrowClient();\n    try {\n      statusCode = httpClient.executeMethod(get);\n      schemaString = get.getResponseBodyAsString();\n    } catch (HttpException e) {\n      throw new RuntimeException(e);\n    } catch (IOException e) {\n      throw new RuntimeException(e);\n    } finally {\n      get.releaseConnection();\n      this.httpClientPool.returnObject(httpClient);\n    }\n\n    if (statusCode != HttpStatus.SC_OK) {\n      throw new SchemaRegistryException(\n          String.format(\"Latest schema for topic %s cannot be retrieved. Status code = %d\", topic, statusCode));\n    }\n\n    Schema schema;\n    try {\n      schema = new Schema.Parser().parse(schemaString);\n    } catch (Throwable t) {\n      throw new SchemaRegistryException(String.format(\"Latest schema for topic %s cannot be retrieved\", topic), t);\n    }\n\n    return schema;\n  }\n","realPath":"gobblin-modules/gobblin-kafka-common/src/main/java/org/apache/gobblin/metrics/kafka/KafkaAvroSchemaRegistry.java","repoName":"gobblin","snippetEndLine":0,"snippetStartLine":0,"startLine":117,"status":"B"}],"commitId":"5457af88d56b8fb89b172129fd1ff24ecdd4eba8","commitMessage":"@@@Merge pull request #2031 from abti/move_packages_to_apache\n","date":"2017-07-31 15:51:25","modifiedFileCount":"2","status":"B","submitter":"Abhishek Tiwari"},{"authorTime":"2018-01-06 13:51:18","codes":[{"authorDate":"2017-07-31 15:51:25","commitOrder":2,"curCode":"  public Schema getLatestSchema(String topic) throws SchemaRegistryException {\n    String schemaUrl = this.url + GET_RESOURCE_BY_TYPE + topic;\n\n    LOG.debug(\"Fetching from URL : \" + schemaUrl);\n\n    GetMethod get = new GetMethod(schemaUrl);\n\n    int statusCode;\n    String schemaString;\n    HttpClient httpClient = this.borrowClient();\n    try {\n      statusCode = httpClient.executeMethod(get);\n      schemaString = get.getResponseBodyAsString();\n    } catch (HttpException e) {\n      throw new RuntimeException(e);\n    } catch (IOException e) {\n      throw new RuntimeException(e);\n    } finally {\n      get.releaseConnection();\n      this.httpClientPool.returnObject(httpClient);\n    }\n\n    if (statusCode != HttpStatus.SC_OK) {\n      throw new SchemaRegistryException(\n          String.format(\"Latest schema for topic %s cannot be retrieved. Status code = %d\", topic, statusCode));\n    }\n\n    Schema schema;\n    try {\n      schema = new Schema.Parser().parse(schemaString);\n    } catch (Throwable t) {\n      throw new SchemaRegistryException(String.format(\"Latest schema for topic %s cannot be retrieved\", topic), t);\n    }\n\n    return schema;\n  }\n","date":"2017-07-31 15:51:25","endLine":138,"groupId":"10457","id":3,"instanceNumber":1,"isCurCommit":0,"methodName":"getLatestSchema","params":"(Stringtopic)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-gobblin-10-0.7/blobInfo/CC_OUT/blobs/2e/a70757aefabe532ba6b279d0e40e9c0816af8d.src","preCode":"  public Schema getLatestSchema(String topic) throws SchemaRegistryException {\n    String schemaUrl = this.url + GET_RESOURCE_BY_TYPE + topic;\n\n    LOG.debug(\"Fetching from URL : \" + schemaUrl);\n\n    GetMethod get = new GetMethod(schemaUrl);\n\n    int statusCode;\n    String schemaString;\n    HttpClient httpClient = this.borrowClient();\n    try {\n      statusCode = httpClient.executeMethod(get);\n      schemaString = get.getResponseBodyAsString();\n    } catch (HttpException e) {\n      throw new RuntimeException(e);\n    } catch (IOException e) {\n      throw new RuntimeException(e);\n    } finally {\n      get.releaseConnection();\n      this.httpClientPool.returnObject(httpClient);\n    }\n\n    if (statusCode != HttpStatus.SC_OK) {\n      throw new SchemaRegistryException(\n          String.format(\"Latest schema for topic %s cannot be retrieved. Status code = %d\", topic, statusCode));\n    }\n\n    Schema schema;\n    try {\n      schema = new Schema.Parser().parse(schemaString);\n    } catch (Throwable t) {\n      throw new SchemaRegistryException(String.format(\"Latest schema for topic %s cannot be retrieved\", topic), t);\n    }\n\n    return schema;\n  }\n","realPath":"gobblin-modules/gobblin-kafka-common/src/main/java/org/apache/gobblin/kafka/schemareg/LiKafkaSchemaRegistry.java","repoName":"gobblin","snippetEndLine":0,"snippetStartLine":0,"startLine":103,"status":"N"},{"authorDate":"2018-01-06 13:51:18","commitOrder":2,"curCode":"  public Schema getLatestSchemaByTopic(String topic) throws SchemaRegistryException {\n    String schemaUrl = KafkaAvroSchemaRegistry.this.url + GET_RESOURCE_BY_TYPE + topic;\n\n    LOG.debug(\"Fetching from URL : \" + schemaUrl);\n    int retryInterval = Integer.parseInt(this.props.getProperty(ConfigurationKeys.KAFKA_SCHEMA_REGISTRY_RETRY_INTERVAL_IN_MILLIS, Integer.toString(5000)));\n    int retryTimes = Integer.parseInt(this.props.getProperty(ConfigurationKeys.KAFKA_SCHEMA_REGISTRY_RETRY_TIMES, Integer.toString(10)));\n    GetMethod get = new GetMethod(schemaUrl);\n\n    int statusCode = -1;\n    String schemaString = \"\";\n    HttpClient httpClient = this.borrowClient();\n    int loop = 0;\n\n    try {\n      while (++loop <= retryTimes) {\n        try {\n          statusCode = httpClient.executeMethod(get);\n          schemaString = get.getResponseBodyAsString();\n          break;\n        } catch (Exception e) {\n          if (loop >= retryTimes) {\n            throw e;\n          } else {\n            log.error(\"Exception when fetching schema : {}\", e.toString());\n            Thread.sleep(retryInterval);\n          }\n        }\n      }\n    } catch (HttpException e) {\n      throw new RuntimeException(e);\n    } catch (IOException e) {\n      throw new RuntimeException(e);\n    } catch (InterruptedException e) {\n      throw new RuntimeException(e);\n    } finally {\n      get.releaseConnection();\n      this.httpClientPool.returnObject(httpClient);\n    }\n\n    if (statusCode != HttpStatus.SC_OK) {\n      throw new SchemaRegistryException(\n          String.format(\"Latest schema for topic %s cannot be retrieved. Status code = %d\", topic, statusCode));\n    }\n\n    Schema schema;\n    try {\n      schema = new Schema.Parser().parse(schemaString);\n    } catch (Throwable t) {\n      throw new SchemaRegistryException(String.format(\"Latest schema for topic %s cannot be retrieved\", topic), t);\n    }\n\n    return schema;\n  }\n","date":"2018-01-06 13:51:18","endLine":190,"groupId":"10457","id":4,"instanceNumber":2,"isCurCommit":0,"methodName":"getLatestSchemaByTopic","params":"(Stringtopic)","path":"/mnt/clonedata/CloneManagementServer/ManagementServer/consistResult/result-gobblin-10-0.7/blobInfo/CC_OUT/blobs/2a/216f2d4fea2849c3d72c4d88eef6b3bbd191e5.src","preCode":"  public Schema getLatestSchemaByTopic(String topic) throws SchemaRegistryException {\n    String schemaUrl = KafkaAvroSchemaRegistry.this.url + GET_RESOURCE_BY_TYPE + topic;\n\n    LOG.debug(\"Fetching from URL : \" + schemaUrl);\n\n    GetMethod get = new GetMethod(schemaUrl);\n\n    int statusCode;\n    String schemaString;\n    HttpClient httpClient = this.borrowClient();\n    try {\n      statusCode = httpClient.executeMethod(get);\n      schemaString = get.getResponseBodyAsString();\n    } catch (HttpException e) {\n      throw new RuntimeException(e);\n    } catch (IOException e) {\n      throw new RuntimeException(e);\n    } finally {\n      get.releaseConnection();\n      this.httpClientPool.returnObject(httpClient);\n    }\n\n    if (statusCode != HttpStatus.SC_OK) {\n      throw new SchemaRegistryException(\n          String.format(\"Latest schema for topic %s cannot be retrieved. Status code = %d\", topic, statusCode));\n    }\n\n    Schema schema;\n    try {\n      schema = new Schema.Parser().parse(schemaString);\n    } catch (Throwable t) {\n      throw new SchemaRegistryException(String.format(\"Latest schema for topic %s cannot be retrieved\", topic), t);\n    }\n\n    return schema;\n  }\n","realPath":"gobblin-modules/gobblin-kafka-common/src/main/java/org/apache/gobblin/metrics/kafka/KafkaAvroSchemaRegistry.java","repoName":"gobblin","snippetEndLine":0,"snippetStartLine":0,"startLine":138,"status":"M"}],"commitId":"760da9a3e557f76fd84a65411c92cdb4615ca81f","commitMessage":"@@@[GOBBLIN-356] Add socket and connection timeout for kafka schema registry\n\nCloses #2228 from yukuai518/schemaregistry\n","date":"2018-01-06 13:51:18","modifiedFileCount":"3","status":"M","submitter":"Kuai Yu"}]
